<?xml version="1.0" encoding="UTF-8"?>
<!-- Created with Jaspersoft Studio version 6.4.2.final using JasperReports Library version 6.4.1  -->
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="projects_status_ki_last" pageWidth="1210" pageHeight="680" orientation="Landscape" columnWidth="1210" leftMargin="0" rightMargin="0" topMargin="0" bottomMargin="0" uuid="9aff8705-15c5-497b-be6c-24835f5aa535">
	<property name="ireport.jasperserver.url" value="https://cppmrpt103.ondemand.ca.com/reportservice/"/>
	<property name="ireport.jasperserver.user" value="report_dev|cppm9100"/>
	<property name="ireport.jasperserver.report.resource" value="/ca_ppm/Honda/honda_project_status_v6_files/projects_status_ki_last.jrxml"/>
	<property name="ireport.jasperserver.reportUnit" value="/ca_ppm/Honda/honda_project_status_v6"/>
	<property name="com.jaspersoft.studio.unit." value="pixel"/>
	<property name="com.jaspersoft.studio.data.defaultdataadapter" value="HONDA - PRD"/>
	<style name="Table_TH" mode="Opaque" backcolor="#F0F8FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Table 1_TH" mode="Opaque" backcolor="#F0F8FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Table 1_CH" mode="Opaque" backcolor="#FFC8AB">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Table 1_TD" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Table 2_TH" mode="Opaque" backcolor="#F0F8FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Table 2_CH" mode="Opaque" backcolor="#FFC8AB">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Table 2_TD" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Table 3_TH" mode="Opaque" backcolor="#F0F8FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Table 3_CH" mode="Opaque" backcolor="#FFC8AB">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Table 3_TD" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<subDataset name="Dados" uuid="8b7503b0-90dc-4677-a7ce-32a8683b14e1">
		<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
		<property name="com.jaspersoft.studio.data.defaultdataadapter" value="HONDA - PRD"/>
		<property name="com.jaspersoft.studio.data.sql.SQLQueryDesigner.sash.w1" value="0"/>
		<property name="com.jaspersoft.studio.data.sql.SQLQueryDesigner.sash.w2" value="1000"/>
		<property name="com.jaspersoft.studio.property.dataset.dialog.DatasetDialog.sash.w1" value="571"/>
		<property name="com.jaspersoft.studio.property.dataset.dialog.DatasetDialog.sash.w2" value="415"/>
		<parameter name="data_referencia" class="java.util.Date"/>
		<parameter name="owner" class="java.util.Collection"/>
		<parameter name="portfolio" class="java.lang.String"/>
		<parameter name="fase" class="java.util.Collection"/>
		<queryString>
			<![CDATA[SELECT
	STATUS_FINAL,
	STATUS_ORDER,
	COUNT(INV_ID) QTD
FROM
(
	SELECT
	INV_ID,
	INV_CODE,
	INV_NAME,
	EXTRA,
	FASE,
	STATUS,
	SCHEDULE_STATUS,
	STATUS_FINAL,
	OWNER,
	CASE
		WHEN STATUS_FINAL = 'No Prazo' THEN 10
		WHEN STATUS_FINAL = 'Demanda No Prazo' THEN 20
		WHEN STATUS_FINAL = 'On hold' THEN 30
		WHEN STATUS_FINAL = 'Demanda On hold' THEN 40
		WHEN STATUS_FINAL = 'Atrasado' THEN 50
		WHEN STATUS_FINAL = 'Demanda Atrasada' THEN 60		
		WHEN STATUS_FINAL = 'Cancelado' THEN 70
		WHEN STATUS_FINAL = 'Demanda Cancelado' THEN 80
		WHEN STATUS_FINAL = 'Extra' THEN 90
		WHEN STATUS_FINAL = 'Sem Status' THEN 100
		WHEN STATUS_FINAL = 'Concluído' THEN 110		
		END STATUS_ORDER	
	FROM
	(
		SELECT
		INV_ID,
		INV_CODE,
		INV_NAME,
		EXTRA,
		FASE,
		OWNER,
		STATUS,
		SCHEDULE_STATUS,
		CASE
			WHEN FASE IN ('Con') THEN 'Concluído'
			WHEN SCHEDULE_STATUS IS NULL THEN 'Sem Status'
			WHEN EXTRA = 1 THEN 'Extra'
			WHEN FASE IN ('A00','U0','U1','J0') AND STATUS IN ('hon_lkp_cancelada','hon_lkp_cancelado') THEN 'Demanda Cancelada'
			WHEN FASE IN ('A00','U0','U1','J0') AND STATUS IN ('hon_lkp_on_hold') THEN 'Demanda On hold'
			WHEN FASE IN ('A00','U0','U1','J0') AND SCHEDULE_STATUS < 0 THEN 'Demanda Atrasada'
			WHEN FASE IN ('A00','U0','U1','J0') AND SCHEDULE_STATUS >= 0 THEN 'Demanda No Prazo'
			WHEN STATUS IN ('hon_lkp_cancelada','hon_lkp_cancelado') THEN 'Cancelado'
			WHEN STATUS IN ('hon_lkp_on_hold') THEN 'On hold'
			WHEN SCHEDULE_STATUS < 0 THEN 'Atrasado'
			ELSE 'No Prazo' 
			END STATUS_FINAL
		FROM
		(
			SELECT
			T1.INV_ID,
			T1.INV_CODE,
			T1.INV_NAME,
			T1.EXTRA,
			T1.OWNER,
			CASE
				WHEN T1.FASE_PRJ = 'Con' THEN T1.FASE_PRJ
				WHEN T2.FASE_ATUAL IS NULL THEN T1.FASE_PRJ
				ELSE T2.FASE_ATUAL
				END FASE,
			T1.FASE_PRJ,
			T1.STATUS,
			T2.CRONO_STATUS	SCHEDULE_STATUS
			FROM
			(
				SELECT 
					INVI.ID INV_ID,
					INVI.CODE INV_CODE,
					INVI.NAME INV_NAME,
					STAGE_ATU.NAME FASE_PRJ,
					STATUS.LOOKUP_CODE STATUS,
					OCINV.hon_extra EXTRA,
					OWNER.NAME OWNER_FULL,
					CASE 
						WHEN OWNER.NAME LIKE 'S - CS' THEN 'CS' 
						WHEN OWNER.NAME LIKE 'S - PARTS' THEN 'SP' 
						WHEN OWNER.NAME LIKE 'EDB - HDA' THEN 'EDB - HDA' 
						WHEN OWNER.NAME LIKE 'HAB - BR - E' THEN 'HAB - E' 
						WHEN OWNER.NAME LIKE 'HAB - BR - DB' THEN 'HAB - DB'		
						WHEN SUBSTR(OWNER.NAME,0,INSTR(OWNER.NAME,' ')-1) = 'TI' THEN 'IT' ELSE SUBSTR(OWNER.NAME,0,INSTR(OWNER.NAME,' ')-1) 
						END OWNER					
				FROM 
					INV_INVESTMENTS INVI
					LEFT JOIN ODF_CA_INV OCINV ON INVI.ID = OCINV.ID
					LEFT JOIN CMN_LOOKUPS_V STATUS ON STATUS.LOOKUP_CODE = OCINV.hon_status AND STATUS.LANGUAGE_CODE = 'pt' AND STATUS.LOOKUP_TYPE = 'HON_STATUS_INVESTIMENTO'
					LEFT JOIN CMN_LOOKUPS_V STAGE_ATU ON INVI.STAGE_CODE = STAGE_ATU.LOOKUP_CODE AND   STAGE_ATU.LANGUAGE_CODE = 'pt' AND STAGE_ATU.LOOKUP_TYPE = 'INV_STAGE_TYPE' AND STAGE_ATU.PARENT_LOOKUP_CODE = 'hon_hsdm'
					LEFT JOIN CMN_LOOKUPS_V OWNER ON OWNER.LOOKUP_CODE = OCINV.hon_area AND OWNER.LANGUAGE_CODE = 'pt' AND OWNER.LOOKUP_TYPE = 'HON_LKP_AREA'
					LEFT JOIN PFM_INVESTMENTS PFMI ON PFMI.INVESTMENT_ID = INVI.ID
					LEFT JOIN PFM_PORTFOLIOS PFMP ON PFMI.PORTFOLIO_ID = PFMP.ID AND PFMP.IS_ACTIVE = 1
				WHERE 
					PFMP.ID = $P{portfolio}
					AND INVI.ODF_OBJECT_CODE = 'project'
			)T1
			
			LEFT JOIN

			(
				SELECT
					DENSE_RANK() OVER (PARTITION BY SRPT.ODF_PARENT_ID ORDER BY SRPT.COP_REPORT_DATE DESC) SRPT_RANK,
					SRPT.ODF_PARENT_ID INV_ID,
					SRPT.NAME SRPT_NAME,
					SRPT.COP_REPORT_DATE DT_RELATORIO,
					FASE_ATUAL.NAME FASE_ATUAL,
					FASE_PLAN.NAME FASE_PLAN,
					TO_CHAR(SRPT.hon_dt_fase_real,'DD/MM/YY') DT_FASE_REAL,
					TO_CHAR(SRPT.hon_dt_fase_plan,'DD/MM/YY') DT_FASE_PLAN,
					TO_CHAR(SRPT.hon_target,'DD/MM/YY') TARGET,
					SRPT.cop_schedule_status CRONO_STATUS,
					SRPT.cop_key_accomplish PRINCIP_REAL,
					SRPT.cop_schedule_exp VARIACAO_PLANO,
					SRPT.cop_upcoming_act PLANO_ACAO,
					CASE 
						WHEN SRPT.cop_schedule_status = -20 THEN 1
						WHEN SRPT.cop_schedule_status = -5 THEN 2        
						WHEN SRPT.cop_schedule_status = 0 THEN 3
						WHEN SRPT.cop_schedule_status = 5 THEN 4
						WHEN SRPT.cop_schedule_status = 20 THEN 5     
						ELSE 0
						END EVAL_SCHEDULE,
					CASE 
						WHEN SRPT.cop_cost_eft_status = -20 THEN 1
						WHEN SRPT.cop_cost_eft_status = -5 THEN 2        
						WHEN SRPT.cop_cost_eft_status = 0 THEN 3
						WHEN SRPT.cop_cost_eft_status = 5 THEN 4
						WHEN SRPT.cop_cost_eft_status = 20 THEN 5     
						ELSE 0
						END EVAL_BUDGET
				FROM
					ODF_CA_COP_PRJ_STATUSRPT SRPT
					LEFT JOIN CMN_LOOKUPS_V FASE_ATUAL ON FASE_ATUAL.LOOKUP_CODE = SRPT.hon_fase_atual AND FASE_ATUAL.LANGUAGE_CODE = 'pt' AND FASE_ATUAL.LOOKUP_TYPE = 'HON_LKP_FASE_PROJETO'
					LEFT JOIN CMN_LOOKUPS_V FASE_PLAN ON FASE_PLAN.LOOKUP_CODE = SRPT.hon_fase_planejada AND FASE_PLAN.LANGUAGE_CODE = 'pt' AND FASE_PLAN.LOOKUP_TYPE = 'HON_LKP_FASE_PROJETO'
				WHERE
					TRUNC(SRPT.COP_REPORT_DATE,'MONTH') = TRUNC(ADD_MONTHS($P{data_referencia},-1),'MONTH')
					AND SRPT.COP_REPORT_STATUS = 'FINAL' 
					AND SRPT.HON_TIPO_REL_STATUS = 'mensal'
			)T2 ON T2.INV_ID = T1.INV_ID AND T2.SRPT_RANK = 1
		)T3
		WHERE 
			$X{IN,OWNER,owner}
			AND $X{IN,FASE,fase}
	)T4
)T5
GROUP BY
	STATUS_FINAL,
	STATUS_ORDER

ORDER BY
	STATUS_ORDER ASC]]>
		</queryString>
		<field name="STATUS_FINAL" class="java.lang.String"/>
		<field name="STATUS_ORDER" class="java.math.BigDecimal"/>
		<field name="QTD" class="java.math.BigDecimal"/>
		<sortField name="STATUS_ORDER"/>
	</subDataset>
	<subDataset name="fases" uuid="bd6d912e-259f-4994-b1b0-372a3d3d3d99">
		<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
		<property name="com.jaspersoft.studio.data.defaultdataadapter" value="HONDA - PRD"/>
		<property name="com.jaspersoft.studio.data.sql.SQLQueryDesigner.sash.w1" value="0"/>
		<property name="com.jaspersoft.studio.data.sql.SQLQueryDesigner.sash.w2" value="1000"/>
		<parameter name="data_referencia" class="java.util.Date"/>
		<parameter name="owner" class="java.util.Collection"/>
		<parameter name="portfolio" class="java.lang.String"/>
		<parameter name="fase" class="java.util.Collection"/>
		<queryString>
			<![CDATA[SELECT
	INV_ID,
	STATUS,
	STATUS_ORDER,
	FASE,
	FASE_ORDER
FROM
(
	SELECT
	INV_ID,
	FASE,
	STATUS_FINAL STATUS,
	CASE
		WHEN STATUS_FINAL = 'Concluído' THEN 10
		WHEN STATUS_FINAL = 'Sem Status' THEN 20
		WHEN STATUS_FINAL = 'Extra' THEN 30
		WHEN STATUS_FINAL = 'Demanda Cancelada' THEN 40
		WHEN STATUS_FINAL = 'Demanda On hold' THEN 50
		WHEN STATUS_FINAL = 'Demanda Atrasada' THEN 60
		WHEN STATUS_FINAL = 'Demanda No Prazo' THEN 70
		WHEN STATUS_FINAL = 'Cancelado' THEN 80
		WHEN STATUS_FINAL = 'On hold' THEN 90
		WHEN STATUS_FINAL = 'Atrasado' THEN 100
		WHEN STATUS_FINAL = 'No Prazo' THEN 110		
		END STATUS_ORDER,	
	CASE
		WHEN FASE = 'A00' THEN 10
		WHEN FASE = 'U0' THEN 20
		WHEN FASE = 'U1' THEN 30
		WHEN FASE = 'J0' THEN 40
		WHEN FASE = 'J1' THEN 50
		WHEN FASE = 'J2' THEN 60
		WHEN FASE = 'J3' THEN 70
		WHEN FASE = 'J4' THEN 80
		WHEN FASE = 'J5' THEN 90
		WHEN FASE = 'OPA' THEN 100
		WHEN FASE = 'PRD' THEN 110
		WHEN FASE = 'P0' THEN 120
		WHEN FASE = 'Con' THEN 130
		WHEN STATUS_FINAL = 'Sem Status' THEN 140
		END FASE_ORDER	
	FROM
	(
		SELECT
		INV_ID,
		INV_CODE,
		INV_NAME,
		EXTRA,
		FASE,
		OWNER,
		STATUS,
		SCHEDULE_STATUS,
		CASE
			WHEN FASE = 'Con' THEN 'Concluído'
			WHEN SCHEDULE_STATUS IS NULL THEN 'Sem Status'
			WHEN EXTRA = 1 THEN 'Extra'
			WHEN FASE IN ('A00','U0','U1','J0') AND STATUS IN ('hon_lkp_cancelada','hon_lkp_cancelado') THEN 'Demanda Cancelada'
			WHEN FASE IN ('A00','U0','U1','J0') AND STATUS IN ('hon_lkp_on_hold') THEN 'Demanda On hold'
			WHEN FASE IN ('A00','U0','U1','J0') AND SCHEDULE_STATUS < 0 THEN 'Demanda Atrasada'
			WHEN FASE IN ('A00','U0','U1','J0') AND SCHEDULE_STATUS >= 0 THEN 'Demanda No Prazo'
			WHEN STATUS IN ('hon_lkp_cancelada','hon_lkp_cancelado') THEN 'Cancelado'
			WHEN STATUS IN ('hon_lkp_on_hold') THEN 'On hold'
			WHEN SCHEDULE_STATUS < 0 THEN 'Atrasado'
			ELSE 'No Prazo' 
			END STATUS_FINAL
		FROM
		(
			SELECT
			T1.INV_ID,
			T1.INV_CODE,
			T1.INV_NAME,
			T1.EXTRA,
			T1.OWNER,
			CASE
				WHEN T1.FASE_PRJ = 'Con' THEN T1.FASE_PRJ
				WHEN T2.FASE_ATUAL IS NULL THEN T1.FASE_PRJ
				ELSE T2.FASE_ATUAL
				END FASE,
			T1.FASE_PRJ,
			T1.STATUS,
			T2.CRONO_STATUS	SCHEDULE_STATUS
			FROM
			(
				SELECT 
					INVI.ID INV_ID,
					INVI.CODE INV_CODE,
					INVI.NAME INV_NAME,
					STAGE_ATU.NAME FASE_PRJ,
					STATUS.LOOKUP_CODE STATUS,
					OCINV.hon_extra EXTRA,
					OWNER.NAME OWNER_FULL,
					CASE 
						WHEN OWNER.NAME LIKE 'S - CS' THEN 'CS' 
						WHEN OWNER.NAME LIKE 'S - PARTS' THEN 'SP' 
						WHEN OWNER.NAME LIKE 'EDB - HDA' THEN 'EDB - HDA' 
						WHEN OWNER.NAME LIKE 'HAB - BR - E' THEN 'HAB - E' 
						WHEN OWNER.NAME LIKE 'HAB - BR - DB' THEN 'HAB - DB'		
						WHEN SUBSTR(OWNER.NAME,0,INSTR(OWNER.NAME,' ')-1) = 'TI' THEN 'IT' ELSE SUBSTR(OWNER.NAME,0,INSTR(OWNER.NAME,' ')-1) 
						END OWNER					
				FROM 
					INV_INVESTMENTS INVI
					LEFT JOIN ODF_CA_INV OCINV ON INVI.ID = OCINV.ID
					LEFT JOIN CMN_LOOKUPS_V STATUS ON STATUS.LOOKUP_CODE = OCINV.hon_status AND STATUS.LANGUAGE_CODE = 'pt' AND STATUS.LOOKUP_TYPE = 'HON_STATUS_INVESTIMENTO'
					LEFT JOIN CMN_LOOKUPS_V STAGE_ATU ON INVI.STAGE_CODE = STAGE_ATU.LOOKUP_CODE AND   STAGE_ATU.LANGUAGE_CODE = 'pt' AND STAGE_ATU.LOOKUP_TYPE = 'INV_STAGE_TYPE' AND STAGE_ATU.PARENT_LOOKUP_CODE = 'hon_hsdm'
					LEFT JOIN CMN_LOOKUPS_V OWNER ON OWNER.LOOKUP_CODE = OCINV.hon_area AND OWNER.LANGUAGE_CODE = 'pt' AND OWNER.LOOKUP_TYPE = 'HON_LKP_AREA'
					LEFT JOIN PFM_INVESTMENTS PFMI ON PFMI.INVESTMENT_ID = INVI.ID
					LEFT JOIN PFM_PORTFOLIOS PFMP ON PFMI.PORTFOLIO_ID = PFMP.ID AND PFMP.IS_ACTIVE = 1
				WHERE 
					PFMP.ID = $P{portfolio}
					AND INVI.ODF_OBJECT_CODE = 'project'
			)T1
			
			LEFT JOIN

			(
				SELECT
					DENSE_RANK() OVER (PARTITION BY SRPT.ODF_PARENT_ID ORDER BY SRPT.COP_REPORT_DATE DESC) SRPT_RANK,
					SRPT.ODF_PARENT_ID INV_ID,
					SRPT.NAME SRPT_NAME,
					SRPT.COP_REPORT_DATE DT_RELATORIO,
					FASE_ATUAL.NAME FASE_ATUAL,
					FASE_PLAN.NAME FASE_PLAN,
					TO_CHAR(SRPT.hon_dt_fase_real,'DD/MM/YY') DT_FASE_REAL,
					TO_CHAR(SRPT.hon_dt_fase_plan,'DD/MM/YY') DT_FASE_PLAN,
					TO_CHAR(SRPT.hon_target,'DD/MM/YY') TARGET,
					SRPT.cop_schedule_status CRONO_STATUS,
					SRPT.cop_key_accomplish PRINCIP_REAL,
					SRPT.cop_schedule_exp VARIACAO_PLANO,
					SRPT.cop_upcoming_act PLANO_ACAO,
					CASE 
						WHEN SRPT.cop_schedule_status = -20 THEN 1
						WHEN SRPT.cop_schedule_status = -5 THEN 2        
						WHEN SRPT.cop_schedule_status = 0 THEN 3
						WHEN SRPT.cop_schedule_status = 5 THEN 4
						WHEN SRPT.cop_schedule_status = 20 THEN 5     
						ELSE 0
						END EVAL_SCHEDULE,
					CASE 
						WHEN SRPT.cop_cost_eft_status = -20 THEN 1
						WHEN SRPT.cop_cost_eft_status = -5 THEN 2        
						WHEN SRPT.cop_cost_eft_status = 0 THEN 3
						WHEN SRPT.cop_cost_eft_status = 5 THEN 4
						WHEN SRPT.cop_cost_eft_status = 20 THEN 5     
						ELSE 0
						END EVAL_BUDGET
				FROM
					ODF_CA_COP_PRJ_STATUSRPT SRPT
					LEFT JOIN CMN_LOOKUPS_V FASE_ATUAL ON FASE_ATUAL.LOOKUP_CODE = SRPT.hon_fase_atual AND FASE_ATUAL.LANGUAGE_CODE = 'pt' AND FASE_ATUAL.LOOKUP_TYPE = 'HON_LKP_FASE_PROJETO'
					LEFT JOIN CMN_LOOKUPS_V FASE_PLAN ON FASE_PLAN.LOOKUP_CODE = SRPT.hon_fase_planejada AND FASE_PLAN.LANGUAGE_CODE = 'pt' AND FASE_PLAN.LOOKUP_TYPE = 'HON_LKP_FASE_PROJETO'
				WHERE
					TRUNC(SRPT.COP_REPORT_DATE,'MONTH') = TRUNC(ADD_MONTHS($P{data_referencia},-1),'MONTH')
					AND SRPT.COP_REPORT_STATUS = 'FINAL' 
					AND SRPT.HON_TIPO_REL_STATUS = 'mensal'
			)T2 ON T2.INV_ID = T1.INV_ID AND T2.SRPT_RANK = 1
		)T3
		WHERE 
			$X{IN,OWNER,owner}
			AND $X{IN,FASE,fase}
	)T4
)T5
ORDER BY
	FASE_ORDER ASC,
	STATUS_ORDER ASC]]>
		</queryString>
		<field name="INV_ID" class="java.math.BigDecimal"/>
		<field name="STATUS" class="java.lang.String"/>
		<field name="STATUS_ORDER" class="java.math.BigDecimal"/>
		<field name="FASE" class="java.lang.String"/>
		<field name="FASE_ORDER" class="java.math.BigDecimal"/>
		<sortField name="FASE_ORDER"/>
	</subDataset>
	<subDataset name="owner" uuid="3e0bcef9-7fdc-40fe-ab90-0002fdb9f3ed">
		<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
		<property name="com.jaspersoft.studio.data.defaultdataadapter" value="HONDA - PRD"/>
		<property name="com.jaspersoft.studio.data.sql.SQLQueryDesigner.sash.w1" value="0"/>
		<property name="com.jaspersoft.studio.data.sql.SQLQueryDesigner.sash.w2" value="1000"/>
		<parameter name="data_referencia" class="java.util.Date"/>
		<parameter name="owner" class="java.util.Collection"/>
		<parameter name="portfolio" class="java.lang.String"/>
		<parameter name="fase" class="java.util.Collection"/>
		<queryString>
			<![CDATA[SELECT
INV_ID,
STATUS,
STATUS_ORDER,
FASE,
FASE_ORDER,
OWNER
FROM
(
	SELECT
	INV_ID,
	FASE,
	OWNER,
	STATUS_FINAL STATUS,
	CASE
		WHEN STATUS_FINAL = 'Concluído' THEN 10
		WHEN STATUS_FINAL = 'Sem Status' THEN 20
		WHEN STATUS_FINAL = 'Extra' THEN 30
		WHEN STATUS_FINAL = 'Demanda Cancelada' THEN 40
		WHEN STATUS_FINAL = 'Demanda On hold' THEN 50
		WHEN STATUS_FINAL = 'Demanda Atrasada' THEN 60
		WHEN STATUS_FINAL = 'Demanda No Prazo' THEN 70
		WHEN STATUS_FINAL = 'Cancelado' THEN 80
		WHEN STATUS_FINAL = 'On hold' THEN 90
		WHEN STATUS_FINAL = 'Atrasado' THEN 100
		WHEN STATUS_FINAL = 'No Prazo' THEN 110		
		END STATUS_ORDER,	
	CASE
		WHEN FASE = 'A00' THEN 10
		WHEN FASE = 'U0' THEN 20
		WHEN FASE = 'U1' THEN 30
		WHEN FASE = 'J0' THEN 40
		WHEN FASE = 'J1' THEN 50
		WHEN FASE = 'J2' THEN 60
		WHEN FASE = 'J3' THEN 70
		WHEN FASE = 'J4' THEN 80
		WHEN FASE = 'J5' THEN 90
		WHEN FASE = 'OPA' THEN 100
		WHEN FASE = 'PRD' THEN 110
		WHEN FASE = 'P0' THEN 120
		WHEN FASE = 'Con' THEN 130
		WHEN STATUS_FINAL = 'Sem Status' THEN 140
		END FASE_ORDER	
	FROM
	(
		SELECT
		INV_ID,
		INV_CODE,
		INV_NAME,
		EXTRA,
		FASE,
		OWNER,
		STATUS,
		SCHEDULE_STATUS,
		CASE
			WHEN FASE IN ('Con') THEN 'Concluído'
			WHEN SCHEDULE_STATUS IS NULL THEN 'Sem Status'
			WHEN EXTRA = 1 THEN 'Extra'
			WHEN FASE IN ('A00','U0','U1','J0') AND STATUS IN ('hon_lkp_cancelada','hon_lkp_cancelado') THEN 'Demanda Cancelada'
			WHEN FASE IN ('A00','U0','U1','J0') AND STATUS IN ('hon_lkp_on_hold') THEN 'Demanda On hold'
			WHEN FASE IN ('A00','U0','U1','J0') AND SCHEDULE_STATUS < 0 THEN 'Demanda Atrasada'
			WHEN FASE IN ('A00','U0','U1','J0') AND SCHEDULE_STATUS >= 0 THEN 'Demanda No Prazo'
			WHEN STATUS IN ('hon_lkp_cancelada','hon_lkp_cancelado') THEN 'Cancelado'
			WHEN STATUS IN ('hon_lkp_on_hold') THEN 'On hold'
			WHEN SCHEDULE_STATUS < 0 THEN 'Atrasado'
			ELSE 'No Prazo' 
			END STATUS_FINAL
		FROM
		(
			SELECT
			T1.INV_ID,
			T1.INV_CODE,
			T1.INV_NAME,
			T1.EXTRA,
			T1.OWNER,
			CASE
				WHEN T1.FASE_PRJ = 'Con' THEN T1.FASE_PRJ
				WHEN T2.FASE_ATUAL IS NULL THEN T1.FASE_PRJ
				ELSE T2.FASE_ATUAL
				END FASE,
			T1.FASE_PRJ,
			T1.STATUS,
			T2.CRONO_STATUS	SCHEDULE_STATUS
			FROM
			(
				SELECT 
					INVI.ID INV_ID,
					INVI.CODE INV_CODE,
					INVI.NAME INV_NAME,
					STAGE_ATU.NAME FASE_PRJ,
					STATUS.LOOKUP_CODE STATUS,
					OCINV.hon_extra EXTRA,
					OWNER.NAME OWNER_FULL,
					CASE 
						WHEN OWNER.NAME LIKE 'S - CS' THEN 'CS' 
						WHEN OWNER.NAME LIKE 'S - PARTS' THEN 'SP' 
						WHEN OWNER.NAME LIKE 'EDB - HDA' THEN 'EDB - HDA' 
						WHEN OWNER.NAME LIKE 'HAB - BR - E' THEN 'HAB - E' 
						WHEN OWNER.NAME LIKE 'HAB - BR - DB' THEN 'HAB - DB'		
						WHEN SUBSTR(OWNER.NAME,0,INSTR(OWNER.NAME,' ')-1) = 'TI' THEN 'IT' ELSE SUBSTR(OWNER.NAME,0,INSTR(OWNER.NAME,' ')-1) 
						END OWNER					
				FROM 
					INV_INVESTMENTS INVI
					LEFT JOIN ODF_CA_INV OCINV ON INVI.ID = OCINV.ID
					LEFT JOIN CMN_LOOKUPS_V STATUS ON STATUS.LOOKUP_CODE = OCINV.hon_status AND STATUS.LANGUAGE_CODE = 'pt' AND STATUS.LOOKUP_TYPE = 'HON_STATUS_INVESTIMENTO'
					LEFT JOIN CMN_LOOKUPS_V STAGE_ATU ON INVI.STAGE_CODE = STAGE_ATU.LOOKUP_CODE AND   STAGE_ATU.LANGUAGE_CODE = 'pt' AND STAGE_ATU.LOOKUP_TYPE = 'INV_STAGE_TYPE' AND STAGE_ATU.PARENT_LOOKUP_CODE = 'hon_hsdm'
					LEFT JOIN CMN_LOOKUPS_V OWNER ON OWNER.LOOKUP_CODE = OCINV.hon_area AND OWNER.LANGUAGE_CODE = 'pt' AND OWNER.LOOKUP_TYPE = 'HON_LKP_AREA'
					LEFT JOIN PFM_INVESTMENTS PFMI ON PFMI.INVESTMENT_ID = INVI.ID
					LEFT JOIN PFM_PORTFOLIOS PFMP ON PFMI.PORTFOLIO_ID = PFMP.ID AND PFMP.IS_ACTIVE = 1
				WHERE 
					PFMP.ID = $P{portfolio}
					AND INVI.ODF_OBJECT_CODE = 'project'
			)T1
			
			LEFT JOIN

			(
				SELECT
					DENSE_RANK() OVER (PARTITION BY SRPT.ODF_PARENT_ID ORDER BY SRPT.COP_REPORT_DATE DESC) SRPT_RANK,
					SRPT.ODF_PARENT_ID INV_ID,
					SRPT.NAME SRPT_NAME,
					SRPT.COP_REPORT_DATE DT_RELATORIO,
					FASE_ATUAL.NAME FASE_ATUAL,
					FASE_PLAN.NAME FASE_PLAN,
					TO_CHAR(SRPT.hon_dt_fase_real,'DD/MM/YY') DT_FASE_REAL,
					TO_CHAR(SRPT.hon_dt_fase_plan,'DD/MM/YY') DT_FASE_PLAN,
					TO_CHAR(SRPT.hon_target,'DD/MM/YY') TARGET,
					SRPT.cop_schedule_status CRONO_STATUS,
					SRPT.cop_key_accomplish PRINCIP_REAL,
					SRPT.cop_schedule_exp VARIACAO_PLANO,
					SRPT.cop_upcoming_act PLANO_ACAO,
					CASE 
						WHEN SRPT.cop_schedule_status = -20 THEN 1
						WHEN SRPT.cop_schedule_status = -5 THEN 2        
						WHEN SRPT.cop_schedule_status = 0 THEN 3
						WHEN SRPT.cop_schedule_status = 5 THEN 4
						WHEN SRPT.cop_schedule_status = 20 THEN 5     
						ELSE 0
						END EVAL_SCHEDULE,
					CASE 
						WHEN SRPT.cop_cost_eft_status = -20 THEN 1
						WHEN SRPT.cop_cost_eft_status = -5 THEN 2        
						WHEN SRPT.cop_cost_eft_status = 0 THEN 3
						WHEN SRPT.cop_cost_eft_status = 5 THEN 4
						WHEN SRPT.cop_cost_eft_status = 20 THEN 5     
						ELSE 0
						END EVAL_BUDGET
				FROM
					ODF_CA_COP_PRJ_STATUSRPT SRPT
					LEFT JOIN CMN_LOOKUPS_V FASE_ATUAL ON FASE_ATUAL.LOOKUP_CODE = SRPT.hon_fase_atual AND FASE_ATUAL.LANGUAGE_CODE = 'pt' AND FASE_ATUAL.LOOKUP_TYPE = 'HON_LKP_FASE_PROJETO'
					LEFT JOIN CMN_LOOKUPS_V FASE_PLAN ON FASE_PLAN.LOOKUP_CODE = SRPT.hon_fase_planejada AND FASE_PLAN.LANGUAGE_CODE = 'pt' AND FASE_PLAN.LOOKUP_TYPE = 'HON_LKP_FASE_PROJETO'
				WHERE
					TRUNC(SRPT.COP_REPORT_DATE,'MONTH') = TRUNC(ADD_MONTHS($P{data_referencia},-1),'MONTH')
					AND SRPT.COP_REPORT_STATUS = 'FINAL' 
					AND SRPT.HON_TIPO_REL_STATUS = 'mensal'
			)T2 ON T2.INV_ID = T1.INV_ID AND T2.SRPT_RANK = 1
		)T3
		WHERE 
			$X{IN,OWNER,owner}
			AND $X{IN,FASE,fase}
	)T4
)T5
ORDER BY
	OWNER ASC,
	FASE_ORDER ASC,
	STATUS_ORDER ASC]]>
		</queryString>
		<field name="INV_ID" class="java.math.BigDecimal"/>
		<field name="STATUS" class="java.lang.String"/>
		<field name="STATUS_ORDER" class="java.math.BigDecimal"/>
		<field name="FASE" class="java.lang.String"/>
		<field name="FASE_ORDER" class="java.math.BigDecimal"/>
		<field name="OWNER" class="java.lang.String"/>
		<sortField name="FASE_ORDER"/>
		<sortField name="OWNER"/>
	</subDataset>
	<subDataset name="Status_kpi" uuid="e7d8a294-3a4e-40be-9f98-d166dafe09b6">
		<property name="com.jaspersoft.studio.data.defaultdataadapter" value="HONDA - PRD"/>
		<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
		<property name="com.jaspersoft.studio.data.sql.SQLQueryDesigner.sash.w1" value="0"/>
		<property name="com.jaspersoft.studio.data.sql.SQLQueryDesigner.sash.w2" value="1000"/>
		<parameter name="data_referencia" class="java.util.Date"/>
		<parameter name="owner" class="java.util.Collection"/>
		<parameter name="portfolio" class="java.lang.String"/>
		<parameter name="fase" class="java.util.Collection"/>
		<queryString>
			<![CDATA[SELECT 
TIPO.NAME META
, SUM(TOTAL) TOTAL
, SUM(QTD_KPI) QTD_KPI
, ROUND(SUM(PCT_KPI),2) PCT_KPI
, SUM(TARGET) TARGET
, SUM(TARGET) - SUM(PCT_KPI) EVAL
, CASE
	WHEN (SUM(TARGET)-SUM(PCT_KPI)) <= 0.80 THEN 1
	WHEN (SUM(TARGET)-SUM(PCT_KPI)) > 0.80 AND (SUM(TARGET)-SUM(PCT_KPI)) <= 0.94 THEN 2
	WHEN (SUM(TARGET)-SUM(PCT_KPI)) > 0.94 AND (SUM(TARGET)-SUM(PCT_KPI)) <= 1.05 THEN 3
	WHEN (SUM(TARGET)-SUM(PCT_KPI)) > 1.05 AND (SUM(TARGET)-SUM(PCT_KPI)) <= 1.19 THEN 4
	WHEN (SUM(TARGET)-SUM(PCT_KPI)) > 1.19 THEN 5
	END EVAL_ID
FROM
(
	SELECT
		COUNT(INV_ID) TOTAL
		, SUM(ON_TIME) QTD_KPI
		, SUM(ON_TIME)/COUNT(INV_ID) PCT_KPI
		, 0 TARGET
		, 'on_time_delivery' TIPO
		, 1 ORDEM
	FROM
	(
		SELECT
			INV_ID
			, CASE
				WHEN FASE_SR IS NULL THEN FASE_PRJ
				ELSE FASE_SR
				END FASE
			, CASE 
				WHEN SCHEDULE_STATUS IN (0,5,20) 
				THEN 1 
				ELSE 0 
				END ON_TIME
			, CASE 
				WHEN OWNER LIKE 'S - CS' THEN 'CS' 
				WHEN OWNER LIKE 'S - PARTS' THEN 'SP' 
				WHEN OWNER LIKE 'EDB - HDA' THEN 'EDB - HDA' 
				WHEN OWNER LIKE 'HAB - BR - E' THEN 'HAB - E' 
				WHEN OWNER LIKE 'HAB - BR - DB' THEN 'HAB - DB'		
				WHEN SUBSTR(OWNER,0,INSTR(OWNER,' ')-1) = 'TI' THEN 'IT' ELSE SUBSTR(OWNER,0,INSTR(OWNER,' ')-1) 
				END OWNER
		FROM
		(
			SELECT 
				INVI.ID INV_ID,
				STAGE_ATU.NAME FASE_PRJ,
				CASE
					WHEN (STATUS_RPT.COP_REPORT_STATUS = 'FINAL' AND STATUS_RPT.HON_TIPO_REL_STATUS = 'mensal')
					THEN STAGE_RPT.NAME
					ELSE NULL
					END FASE_SR,
				CASE
					WHEN (STATUS_RPT.COP_REPORT_STATUS = 'FINAL' AND STATUS_RPT.HON_TIPO_REL_STATUS = 'mensal')
					THEN STATUS_RPT.COP_SCHEDULE_STATUS
					ELSE NULL
					END SCHEDULE_STATUS,
				STATUS.LOOKUP_CODE STATUS,
				OWNER.NAME OWNER	
			FROM 
				INV_INVESTMENTS INVI
				JOIN ODF_CA_INV OCINV ON INVI.ID = OCINV.ID
				LEFT JOIN CMN_LOOKUPS_V STATUS ON STATUS.LOOKUP_CODE = OCINV.hon_status AND STATUS.LANGUAGE_CODE = 'pt' AND STATUS.LOOKUP_TYPE = 'HON_STATUS_INVESTIMENTO'
				LEFT JOIN CMN_LOOKUPS_V STAGE_ATU ON INVI.STAGE_CODE = STAGE_ATU.LOOKUP_CODE AND   STAGE_ATU.LANGUAGE_CODE = 'pt' AND STAGE_ATU.LOOKUP_TYPE = 'INV_STAGE_TYPE' AND STAGE_ATU.PARENT_LOOKUP_CODE = 'hon_hsdm'
				LEFT JOIN CMN_LOOKUPS_V OWNER ON OWNER.LOOKUP_CODE = OCINV.hon_area AND OWNER.LANGUAGE_CODE = 'pt' AND OWNER.LOOKUP_TYPE = 'HON_LKP_AREA'
				LEFT JOIN (SELECT MAX(ID) MAX_ID, ODF_PARENT_ID INV_ID FROM odf_ca_cop_prj_statusrpt WHERE TRUNC(COP_REPORT_DATE,'MONTH') <= TRUNC(ADD_MONTHS($P{data_referencia},-1),'MONTH') AND COP_REPORT_STATUS = 'FINAL' AND HON_TIPO_REL_STATUS = 'mensal' GROUP BY ODF_PARENT_ID) MAX_REPORT ON MAX_REPORT.INV_ID = INVI.ID
				LEFT JOIN odf_ca_cop_prj_statusrpt STATUS_RPT ON MAX_REPORT.MAX_ID = STATUS_RPT.ID 
				LEFT JOIN PFM_INVESTMENTS PFMI ON PFMI.INVESTMENT_ID = INVI.ID
				LEFT JOIN PFM_PORTFOLIOS PFMP ON PFMI.PORTFOLIO_ID = PFMP.ID
				LEFT JOIN (SELECT MAX(ID) MAX_AUDIT, OBJECT_ID INV_ID from cmn_audits where ATTRIBUTE_CODE = 'stage_code' AND  LAST_UPDATED_DATE <= TRUNC(ADD_MONTHS($P{data_referencia},-1),'MONTH') GROUP BY OBJECT_ID) MAX_AUDIT ON MAX_AUDIT.INV_ID = INVI.ID
				LEFT JOIN CMN_AUDITS AUD ON AUD.ID = MAX_AUDIT.MAX_AUDIT
				LEFT JOIN CMN_LOOKUPS_V STAGE ON AUD.RAW_VALUE_AFTER = STAGE.LOOKUP_CODE AND   STAGE.LANGUAGE_CODE = 'pt' AND STAGE.LOOKUP_TYPE = 'INV_STAGE_TYPE' AND STAGE.PARENT_LOOKUP_CODE = 'hon_hsdm' 
				LEFT JOIN CMN_LOOKUPS_V STAGE_RPT ON STAGE_RPT.LOOKUP_CODE = STATUS_RPT.hon_fase_atual AND STAGE_RPT.LANGUAGE_CODE = 'pt' AND STAGE_RPT.LOOKUP_TYPE = 'HON_LKP_FASE_PROJETO'
			WHERE 
				 PFMP.ID = $P{portfolio} 
				AND INVI.ODF_OBJECT_CODE = 'project'
		)
	)
	WHERE 
		$X{IN,OWNER,owner}
		AND $X{IN,FASE,fase}

	UNION

	SELECT 
	0 TOTAL
	, 0 QTD_KPI
	, 0 PCT_KPI
	, HON_META TARGET_PCT
	, HON_TIPO_META
	,1 ORDEM
	FROM
		ODF_CA_HON_META META
	WHERE 
		META.hon_tipo_meta = 'on_time_delivery'
		AND META.HON_DATA_INI = (SELECT MAX(HON_DATA_INI) FROM ODF_CA_HON_META WHERE HON_TIPO_META = 'on_time_delivery' AND HON_DATA_INI <= TRUNC(ADD_MONTHS($P{data_referencia},-1),'MONTH') )

) 
KPI
JOIN CMN_LOOKUPS_V TIPO ON TIPO.LOOKUP_TYPE = 'HON_LKP_TIPOS_META' AND TIPO.LOOKUP_CODE = KPI.TIPO AND TIPO.LANGUAGE_CODE = 'pt'

GROUP BY
TIPO.NAME

UNION ALL

SELECT 
TIPO.NAME META
, SUM(TOTAL) TOTAL
, SUM(QTD_KPI) QTD_KPI
, ROUND(SUM(PCT_KPI),2) PCT_KPI
, SUM(TARGET) TARGET
, SUM(TARGET) - SUM(PCT_KPI) EVAL
, CASE
	WHEN (SUM(TARGET)-SUM(PCT_KPI)) <= 0.80 THEN 1
	WHEN (SUM(TARGET)-SUM(PCT_KPI)) > 0.80 AND (SUM(TARGET)-SUM(PCT_KPI)) <= 0.94 THEN 2
	WHEN (SUM(TARGET)-SUM(PCT_KPI)) > 0.94 AND (SUM(TARGET)-SUM(PCT_KPI)) <= 1.05 THEN 3
	WHEN (SUM(TARGET)-SUM(PCT_KPI)) > 1.05 AND (SUM(TARGET)-SUM(PCT_KPI)) <= 1.19 THEN 4
	WHEN (SUM(TARGET)-SUM(PCT_KPI)) > 1.19 THEN 5
	END EVAL_ID
FROM

(
	SELECT
		COUNT(INV_ID) TOTAL
		, SUM(ON_TIME) QTD_KPI
		, SUM(ON_TIME)/COUNT(INV_ID) PCT_KPI
		, 0 TARGET
		, 'prj_cost_on_plan' TIPO
		, 2 ORDEM
	FROM
	(
		SELECT
			INV_ID
			, CASE
				WHEN FASE_SR IS NULL THEN FASE_PRJ
				ELSE FASE_SR
				END FASE
			, CASE 
				WHEN COST_STATUS IN (0,5,20) 
				THEN 1 
				ELSE 0 
				END ON_TIME
			, CASE 
				WHEN OWNER LIKE 'S - CS' THEN 'CS' 
				WHEN OWNER LIKE 'S - PARTS' THEN 'SP' 
				WHEN OWNER LIKE 'EDB - HDA' THEN 'EDB - HDA' 
				WHEN OWNER LIKE 'HAB - BR - E' THEN 'HAB - E' 
				WHEN OWNER LIKE 'HAB - BR - DB' THEN 'HAB - DB'		
				WHEN SUBSTR(OWNER,0,INSTR(OWNER,' ')-1) = 'TI' THEN 'IT' ELSE SUBSTR(OWNER,0,INSTR(OWNER,' ')-1) 
				END OWNER
		FROM
		(
			SELECT 
				INVI.ID INV_ID,
				STAGE_ATU.NAME FASE_PRJ,
				CASE
					WHEN (STATUS_RPT.COP_REPORT_STATUS = 'FINAL' AND STATUS_RPT.HON_TIPO_REL_STATUS = 'mensal')
					THEN STAGE_RPT.NAME
					ELSE NULL
					END FASE_SR,
				CASE
					WHEN (STATUS_RPT.COP_REPORT_STATUS = 'FINAL' AND STATUS_RPT.HON_TIPO_REL_STATUS = 'mensal')
					THEN STATUS_RPT.COP_COST_EFT_STATUS
					ELSE NULL
					END COST_STATUS,
				STATUS.LOOKUP_CODE STATUS,
				OWNER.NAME OWNER	
			FROM 
				INV_INVESTMENTS INVI
				JOIN ODF_CA_INV OCINV ON INVI.ID = OCINV.ID
				LEFT JOIN CMN_LOOKUPS_V STATUS ON STATUS.LOOKUP_CODE = OCINV.hon_status AND STATUS.LANGUAGE_CODE = 'pt' AND STATUS.LOOKUP_TYPE = 'HON_STATUS_INVESTIMENTO'
				LEFT JOIN CMN_LOOKUPS_V STAGE_ATU ON INVI.STAGE_CODE = STAGE_ATU.LOOKUP_CODE AND   STAGE_ATU.LANGUAGE_CODE = 'pt' AND STAGE_ATU.LOOKUP_TYPE = 'INV_STAGE_TYPE' AND STAGE_ATU.PARENT_LOOKUP_CODE = 'hon_hsdm'
				LEFT JOIN CMN_LOOKUPS_V OWNER ON OWNER.LOOKUP_CODE = OCINV.hon_area AND OWNER.LANGUAGE_CODE = 'pt' AND OWNER.LOOKUP_TYPE = 'HON_LKP_AREA'
				LEFT JOIN (SELECT MAX(ID) MAX_ID, ODF_PARENT_ID INV_ID FROM odf_ca_cop_prj_statusrpt WHERE TRUNC(COP_REPORT_DATE,'MONTH') <= TRUNC(ADD_MONTHS($P{data_referencia},-1),'MONTH') AND COP_REPORT_STATUS = 'FINAL' AND HON_TIPO_REL_STATUS = 'mensal' GROUP BY ODF_PARENT_ID) MAX_REPORT ON MAX_REPORT.INV_ID = INVI.ID
				LEFT JOIN odf_ca_cop_prj_statusrpt STATUS_RPT ON MAX_REPORT.MAX_ID = STATUS_RPT.ID 
				LEFT JOIN PFM_INVESTMENTS PFMI ON PFMI.INVESTMENT_ID = INVI.ID
				LEFT JOIN PFM_PORTFOLIOS PFMP ON PFMI.PORTFOLIO_ID = PFMP.ID
				LEFT JOIN (SELECT MAX(ID) MAX_AUDIT, OBJECT_ID INV_ID from cmn_audits where ATTRIBUTE_CODE = 'stage_code' AND  LAST_UPDATED_DATE <= TRUNC(ADD_MONTHS($P{data_referencia},-1),'MONTH') GROUP BY OBJECT_ID) MAX_AUDIT ON MAX_AUDIT.INV_ID = INVI.ID
				LEFT JOIN CMN_AUDITS AUD ON AUD.ID = MAX_AUDIT.MAX_AUDIT
				LEFT JOIN CMN_LOOKUPS_V STAGE ON AUD.RAW_VALUE_AFTER = STAGE.LOOKUP_CODE AND   STAGE.LANGUAGE_CODE = 'pt' AND STAGE.LOOKUP_TYPE = 'INV_STAGE_TYPE' AND STAGE.PARENT_LOOKUP_CODE = 'hon_hsdm' 
				LEFT JOIN CMN_LOOKUPS_V STAGE_RPT ON STAGE_RPT.LOOKUP_CODE = STATUS_RPT.hon_fase_atual AND STAGE_RPT.LANGUAGE_CODE = 'pt' AND STAGE_RPT.LOOKUP_TYPE = 'HON_LKP_FASE_PROJETO'
			WHERE 
				PFMP.ID = $P{portfolio} 
				AND INVI.ODF_OBJECT_CODE = 'project'
		)
	)
	WHERE 
		$X{IN,OWNER,owner}
		AND $X{IN,FASE,fase}

	UNION

	SELECT 
		0 TOTAL
		, 0 QTD_KPI
		, 0 PCT_KPI
		, HON_META TARGET_PCT
		, HON_TIPO_META
		, 2 ORDEM
	FROM
		ODF_CA_HON_META META
	WHERE 
		META.hon_tipo_meta = 'prj_cost_on_plan'
		AND META.HON_DATA_INI = (SELECT MAX(HON_DATA_INI) FROM ODF_CA_HON_META WHERE HON_TIPO_META = 'on_time_delivery' AND HON_DATA_INI <= TRUNC(ADD_MONTHS($P{data_referencia},-1),'MONTH'))
) KPI
JOIN CMN_LOOKUPS_V TIPO ON TIPO.LOOKUP_TYPE = 'HON_LKP_TIPOS_META' AND TIPO.LOOKUP_CODE = KPI.TIPO AND TIPO.LANGUAGE_CODE = 'pt'

GROUP BY
TIPO.NAME]]>
		</queryString>
		<field name="META" class="java.lang.String"/>
		<field name="TOTAL" class="java.math.BigDecimal"/>
		<field name="QTD_KPI" class="java.math.BigDecimal"/>
		<field name="PCT_KPI" class="java.math.BigDecimal"/>
		<field name="TARGET" class="java.math.BigDecimal"/>
		<field name="EVAL" class="java.math.BigDecimal"/>
		<field name="EVAL_ID" class="java.math.BigDecimal"/>
	</subDataset>
	<subDataset name="tests_kpi" uuid="16bba305-b915-41e8-a3a1-9f8bb7f9916d">
		<property name="com.jaspersoft.studio.data.defaultdataadapter" value="HONDA - PRD"/>
		<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
		<property name="com.jaspersoft.studio.data.sql.SQLQueryDesigner.sash.w1" value="0"/>
		<property name="com.jaspersoft.studio.data.sql.SQLQueryDesigner.sash.w2" value="1000"/>
		<parameter name="data_referencia" class="java.util.Date"/>
		<parameter name="owner" class="java.util.Collection"/>
		<parameter name="portfolio" class="java.lang.String"/>
		<parameter name="fase" class="java.util.Collection"/>
		<queryString>
			<![CDATA[SELECT 
TIPO.NAME META
, SUM(TOTAL) TOTAL
, SUM(QTD_KPI) QTD_KPI
, ROUND(SUM(PCT_KPI),2) PCT_KPI
, SUM(TARGET) TARGET
, SUM(TARGET) - SUM(PCT_KPI) EVAL
, CASE
	WHEN (SUM(TARGET)-SUM(PCT_KPI)) <= 0.80 THEN 1
	WHEN (SUM(TARGET)-SUM(PCT_KPI)) > 0.80 AND (SUM(TARGET)-SUM(PCT_KPI)) <= 0.94 THEN 2
	WHEN (SUM(TARGET)-SUM(PCT_KPI)) > 0.94 AND (SUM(TARGET)-SUM(PCT_KPI)) <= 1.05 THEN 3
	WHEN (SUM(TARGET)-SUM(PCT_KPI)) > 1.05 AND (SUM(TARGET)-SUM(PCT_KPI)) <= 1.19 THEN 4
	WHEN (SUM(TARGET)-SUM(PCT_KPI)) > 1.19 THEN 5
	END EVAL_ID
FROM
(
	SELECT
	SUM(TESTE) TOTAL
	, SUM(ISSUE) QTD_KPI
	, SUM(ISSUE)/SUM(TESTE) PCT_KPI
	, 0 TARGET
	, 'issues_j4_req' TIPO
	, 3  ORDEM
	FROM
	(
		SELECT
		TESTE,
		ISSUE,
		CASE
			WHEN FASE_SR IS NULL THEN FASE_PRJ
			ELSE FASE_SR
			END FASE,
		OWNER
		FROM
		(
			SELECT 
			1 TESTE
			, 0 ISSUE
			, STAGE.NAME FASE_PRJ
			, CASE
				WHEN (STATUS_RPT.COP_REPORT_STATUS = 'FINAL' AND STATUS_RPT.HON_TIPO_REL_STATUS = 'mensal')
				THEN STAGE_RPT.NAME
				ELSE NULL
				END FASE_SR
			, CASE 
				WHEN OWNER.NAME LIKE 'S - CS' THEN 'CS' 
				WHEN OWNER.NAME LIKE 'S - PARTS' THEN 'SP' 
				WHEN OWNER.NAME LIKE 'EDB - HDA' THEN 'EDB - HDA' 
				WHEN OWNER.NAME LIKE 'HAB - BR - E' THEN 'HAB - E' 
				WHEN OWNER.NAME LIKE 'HAB - BR - DB' THEN 'HAB - DB'		
				WHEN SUBSTR(OWNER.NAME,0,INSTR(OWNER.NAME,' ')-1) = 'TI' THEN 'IT' 
				ELSE SUBSTR(OWNER.NAME,0,INSTR(OWNER.NAME,' ')-1) 
				END OWNER				
			FROM 
				INV_INVESTMENTS INVI
				LEFT JOIN ODF_CA_INV OCINV ON INVI.ID = OCINV.ID
				LEFT JOIN CMN_LOOKUPS_V STATUS ON STATUS.LOOKUP_CODE = OCINV.hon_status AND STATUS.LANGUAGE_CODE = 'pt' AND STATUS.LOOKUP_TYPE = 'HON_STATUS_INVESTIMENTO'
				LEFT JOIN CMN_LOOKUPS_V STAGE_ATU ON INVI.STAGE_CODE = STAGE_ATU.LOOKUP_CODE AND   STAGE_ATU.LANGUAGE_CODE = 'pt' AND STAGE_ATU.LOOKUP_TYPE = 'INV_STAGE_TYPE' AND STAGE_ATU.PARENT_LOOKUP_CODE = 'hon_hsdm'
				LEFT JOIN CMN_LOOKUPS_V OWNER ON OWNER.LOOKUP_CODE = OCINV.hon_area AND OWNER.LANGUAGE_CODE = 'pt' AND OWNER.LOOKUP_TYPE = 'HON_LKP_AREA'
				LEFT JOIN (SELECT MAX(ID) MAX_ID, ODF_PARENT_ID INV_ID FROM odf_ca_cop_prj_statusrpt WHERE TRUNC(COP_REPORT_DATE,'MONTH') <= TRUNC(ADD_MONTHS($P{data_referencia},-1),'MONTH') AND COP_REPORT_STATUS = 'FINAL' AND HON_TIPO_REL_STATUS = 'mensal' GROUP BY ODF_PARENT_ID) MAX_REPORT ON MAX_REPORT.INV_ID = INVI.ID
				LEFT JOIN odf_ca_cop_prj_statusrpt STATUS_RPT ON MAX_REPORT.MAX_ID = STATUS_RPT.ID 
				LEFT JOIN PFM_INVESTMENTS PFMI ON PFMI.INVESTMENT_ID = INVI.ID
				LEFT JOIN PFM_PORTFOLIOS PFMP ON PFMI.PORTFOLIO_ID = PFMP.ID
				LEFT JOIN (SELECT MAX(ID) MAX_AUDIT, OBJECT_ID INV_ID from cmn_audits where ATTRIBUTE_CODE = 'stage_code' AND  LAST_UPDATED_DATE <= TRUNC(ADD_MONTHS($P{data_referencia},-1),'MONTH') GROUP BY OBJECT_ID) MAX_AUDIT ON MAX_AUDIT.INV_ID = INVI.ID
				LEFT JOIN CMN_AUDITS AUD ON AUD.ID = MAX_AUDIT.MAX_AUDIT
				LEFT JOIN CMN_LOOKUPS_V STAGE ON AUD.RAW_VALUE_AFTER = STAGE.LOOKUP_CODE AND STAGE.LANGUAGE_CODE = 'pt' AND STAGE.LOOKUP_TYPE = 'INV_STAGE_TYPE' AND STAGE.PARENT_LOOKUP_CODE = 'hon_hsdm' 
				LEFT JOIN CMN_LOOKUPS_V STAGE_RPT ON STAGE_RPT.LOOKUP_CODE = STATUS_RPT.hon_fase_atual AND STAGE_RPT.LANGUAGE_CODE = 'pt' AND STAGE_RPT.LOOKUP_TYPE = 'HON_LKP_FASE_PROJETO'
				LEFT JOIN ODF_CA_HON_TESTES TESTES ON TESTES.ODF_PARENT_ID = INVI.ID
			WHERE 
				PFMP.ID = $P{portfolio} 
				AND INVI.ODF_OBJECT_CODE = 'project'
				AND TESTES.hon_fase_testes = 'hon_lkp_j4_ti'
		)

		UNION

		SELECT
		TESTE,
		ISSUE,
		CASE
			WHEN FASE_SR IS NULL THEN FASE_PRJ
			ELSE FASE_SR
			END FASE,
		OWNER
		FROM
		(
			SELECT 
				0 TESTE
				, 1 ISSUE
				, STAGE.NAME FASE_PRJ
				, CASE
					WHEN (STATUS_RPT.COP_REPORT_STATUS = 'FINAL' AND STATUS_RPT.HON_TIPO_REL_STATUS = 'mensal')
					THEN STAGE_RPT.NAME
					ELSE NULL
					END FASE_SR
				, CASE 
					WHEN OWNER.NAME LIKE 'S - CS' THEN 'CS' 
					WHEN OWNER.NAME LIKE 'S - PARTS' THEN 'SP' 
					WHEN OWNER.NAME LIKE 'EDB - HDA' THEN 'EDB - HDA' 
					WHEN OWNER.NAME LIKE 'HAB - BR - E' THEN 'HAB - E' 
					WHEN OWNER.NAME LIKE 'HAB - BR - DB' THEN 'HAB - DB'		
					WHEN SUBSTR(OWNER.NAME,0,INSTR(OWNER.NAME,' ')-1) = 'TI' THEN 'IT' ELSE SUBSTR(OWNER.NAME,0,INSTR(OWNER.NAME,' ')-1) 
					END OWNER				
			FROM 
				INV_INVESTMENTS INVI
				LEFT JOIN ODF_CA_INV OCINV ON INVI.ID = OCINV.ID
				LEFT JOIN CMN_LOOKUPS_V STATUS ON STATUS.LOOKUP_CODE = OCINV.hon_status AND STATUS.LANGUAGE_CODE = 'pt' AND STATUS.LOOKUP_TYPE = 'HON_STATUS_INVESTIMENTO'
				LEFT JOIN CMN_LOOKUPS_V STAGE_ATU ON INVI.STAGE_CODE = STAGE_ATU.LOOKUP_CODE AND   STAGE_ATU.LANGUAGE_CODE = 'pt' AND STAGE_ATU.LOOKUP_TYPE = 'INV_STAGE_TYPE' AND STAGE_ATU.PARENT_LOOKUP_CODE = 'hon_hsdm'
				LEFT JOIN CMN_LOOKUPS_V OWNER ON OWNER.LOOKUP_CODE = OCINV.hon_area AND OWNER.LANGUAGE_CODE = 'pt' AND OWNER.LOOKUP_TYPE = 'HON_LKP_AREA'
				LEFT JOIN (SELECT MAX(ID) MAX_ID, ODF_PARENT_ID INV_ID FROM odf_ca_cop_prj_statusrpt WHERE TRUNC(COP_REPORT_DATE,'MONTH') <= TRUNC(ADD_MONTHS($P{data_referencia},-1),'MONTH') AND COP_REPORT_STATUS = 'FINAL' AND HON_TIPO_REL_STATUS = 'mensal' GROUP BY ODF_PARENT_ID) MAX_REPORT ON MAX_REPORT.INV_ID = INVI.ID
				LEFT JOIN odf_ca_cop_prj_statusrpt STATUS_RPT ON MAX_REPORT.MAX_ID = STATUS_RPT.ID 
				LEFT JOIN PFM_INVESTMENTS PFMI ON PFMI.INVESTMENT_ID = INVI.ID
				LEFT JOIN PFM_PORTFOLIOS PFMP ON PFMI.PORTFOLIO_ID = PFMP.ID
				LEFT JOIN (SELECT MAX(ID) MAX_AUDIT, OBJECT_ID INV_ID from cmn_audits where ATTRIBUTE_CODE = 'stage_code' AND  LAST_UPDATED_DATE <= TRUNC( $P{data_referencia},'MONTH')-1 GROUP BY OBJECT_ID) MAX_AUDIT ON MAX_AUDIT.INV_ID = INVI.ID
				LEFT JOIN CMN_AUDITS AUD ON AUD.ID = MAX_AUDIT.MAX_AUDIT
				LEFT JOIN CMN_LOOKUPS_V STAGE ON AUD.RAW_VALUE_AFTER = STAGE.LOOKUP_CODE AND   STAGE.LANGUAGE_CODE = 'pt' AND STAGE.LOOKUP_TYPE = 'INV_STAGE_TYPE' AND STAGE.PARENT_LOOKUP_CODE = 'hon_hsdm' 
				LEFT JOIN CMN_LOOKUPS_V STAGE_RPT ON STAGE_RPT.LOOKUP_CODE = STATUS_RPT.hon_fase_atual AND STAGE_RPT.LANGUAGE_CODE = 'pt' AND STAGE_RPT.LOOKUP_TYPE = 'HON_LKP_FASE_PROJETO'
				LEFT JOIN RIM_RISKS_AND_ISSUES ISSUE ON ISSUE.PK_ID = INVI.ID JOIN ODF_CA_ISSUE OCI ON ISSUE.ID = OCI.ID

			WHERE
				PFMP.ID = $P{portfolio} 
				AND INVI.ODF_OBJECT_CODE = 'project'
				AND ISSUE.TYPE_CODE = 'ISSUE'
				AND OCI.hon_fase_testes = 'hon_lkp_j4_ti'
		)
	)
	WHERE 
		$X{IN,OWNER,owner}
		AND $X{IN,FASE,fase}

	UNION

	SELECT 
		0 TOTAL
		, 0 QTD_KPI
		, 0 PCT_KPI
		, HON_META TARGET_PCT
		, HON_TIPO_META
		, 3 ORDEM

	FROM
		ODF_CA_HON_META META
	WHERE 
		META.hon_tipo_meta = 'issues_j4_req'
		AND META.HON_DATA_INI = (SELECT MAX(HON_DATA_INI) FROM ODF_CA_HON_META WHERE HON_TIPO_META = 'issues_j4_req' AND HON_DATA_INI <= TRUNC(ADD_MONTHS($P{data_referencia},-1),'MONTH'))

) KPI
JOIN CMN_LOOKUPS_V TIPO ON TIPO.LOOKUP_TYPE = 'HON_LKP_TIPOS_META' AND TIPO.LOOKUP_CODE = KPI.TIPO AND TIPO.LANGUAGE_CODE = 'pt'

GROUP BY
TIPO.NAME

UNION ALL

SELECT 
TIPO.NAME META
, SUM(TOTAL) TOTAL
, SUM(QTD_KPI) QTD_KPI
, ROUND(SUM(PCT_KPI),2) PCT_KPI
, SUM(TARGET) TARGET
, SUM(TARGET) - SUM(PCT_KPI) EVAL
, CASE
	WHEN (SUM(TARGET)-SUM(PCT_KPI)) <= 0.80 THEN 1
	WHEN (SUM(TARGET)-SUM(PCT_KPI)) > 0.80 AND (SUM(TARGET)-SUM(PCT_KPI)) <= 0.94 THEN 2
	WHEN (SUM(TARGET)-SUM(PCT_KPI)) > 0.94 AND (SUM(TARGET)-SUM(PCT_KPI)) <= 1.05 THEN 3
	WHEN (SUM(TARGET)-SUM(PCT_KPI)) > 1.05 AND (SUM(TARGET)-SUM(PCT_KPI)) <= 1.19 THEN 4
	WHEN (SUM(TARGET)-SUM(PCT_KPI)) > 1.19 THEN 5
	END EVAL_ID
FROM
(
	SELECT
	SUM(TESTE) TOTAL
	, SUM(ISSUE) QTD_KPI
	, SUM(ISSUE)/SUM(TESTE) PCT_KPI
	, 0 TARGET
	, 'issues_j5_req' TIPO
	, 4  ORDEM
	FROM
	(
		SELECT
		TESTE,
		ISSUE,
		CASE
			WHEN FASE_SR IS NULL THEN FASE_PRJ
			ELSE FASE_SR
			END FASE,
		OWNER
		FROM
		(
			SELECT 
			1 TESTE
			, 0 ISSUE
			, STAGE.NAME FASE_PRJ
			, CASE
				WHEN (STATUS_RPT.COP_REPORT_STATUS = 'FINAL' AND STATUS_RPT.HON_TIPO_REL_STATUS = 'mensal')
				THEN STAGE_RPT.NAME
				ELSE NULL
				END FASE_SR
			, CASE 
				WHEN OWNER.NAME LIKE 'S - CS' THEN 'CS' 
				WHEN OWNER.NAME LIKE 'S - PARTS' THEN 'SP' 
				WHEN OWNER.NAME LIKE 'EDB - HDA' THEN 'EDB - HDA' 
				WHEN OWNER.NAME LIKE 'HAB - BR - E' THEN 'HAB - E' 
				WHEN OWNER.NAME LIKE 'HAB - BR - DB' THEN 'HAB - DB'		
				WHEN SUBSTR(OWNER.NAME,0,INSTR(OWNER.NAME,' ')-1) = 'TI' THEN 'IT' 
				ELSE SUBSTR(OWNER.NAME,0,INSTR(OWNER.NAME,' ')-1) 
				END OWNER	
		FROM 
			INV_INVESTMENTS INVI
			LEFT JOIN ODF_CA_INV OCINV ON INVI.ID = OCINV.ID
			LEFT JOIN CMN_LOOKUPS_V STATUS ON STATUS.LOOKUP_CODE = OCINV.hon_status AND STATUS.LANGUAGE_CODE = 'pt' AND STATUS.LOOKUP_TYPE = 'HON_STATUS_INVESTIMENTO'
			LEFT JOIN CMN_LOOKUPS_V STAGE_ATU ON INVI.STAGE_CODE = STAGE_ATU.LOOKUP_CODE AND   STAGE_ATU.LANGUAGE_CODE = 'pt' AND STAGE_ATU.LOOKUP_TYPE = 'INV_STAGE_TYPE' AND STAGE_ATU.PARENT_LOOKUP_CODE = 'hon_hsdm'
			LEFT JOIN CMN_LOOKUPS_V OWNER ON OWNER.LOOKUP_CODE = OCINV.hon_area AND OWNER.LANGUAGE_CODE = 'pt' AND OWNER.LOOKUP_TYPE = 'HON_LKP_AREA'
				LEFT JOIN (SELECT MAX(ID) MAX_ID, ODF_PARENT_ID INV_ID FROM odf_ca_cop_prj_statusrpt WHERE TRUNC(COP_REPORT_DATE,'MONTH') <= TRUNC(ADD_MONTHS($P{data_referencia},-1),'MONTH') AND COP_REPORT_STATUS = 'FINAL' AND HON_TIPO_REL_STATUS = 'mensal' GROUP BY ODF_PARENT_ID) MAX_REPORT ON MAX_REPORT.INV_ID = INVI.ID
				LEFT JOIN odf_ca_cop_prj_statusrpt STATUS_RPT ON MAX_REPORT.MAX_ID = STATUS_RPT.ID 
			LEFT JOIN PFM_INVESTMENTS PFMI ON PFMI.INVESTMENT_ID = INVI.ID
			LEFT JOIN PFM_PORTFOLIOS PFMP ON PFMI.PORTFOLIO_ID = PFMP.ID
			LEFT JOIN (SELECT MAX(ID) MAX_AUDIT, OBJECT_ID INV_ID from cmn_audits where ATTRIBUTE_CODE = 'stage_code' AND  LAST_UPDATED_DATE <= TRUNC(ADD_MONTHS($P{data_referencia},-1),'MONTH') GROUP BY OBJECT_ID) MAX_AUDIT ON MAX_AUDIT.INV_ID = INVI.ID
			LEFT JOIN CMN_AUDITS AUD ON AUD.ID = MAX_AUDIT.MAX_AUDIT
			LEFT JOIN CMN_LOOKUPS_V STAGE ON AUD.RAW_VALUE_AFTER = STAGE.LOOKUP_CODE AND   STAGE.LANGUAGE_CODE = 'pt' AND STAGE.LOOKUP_TYPE = 'INV_STAGE_TYPE' AND STAGE.PARENT_LOOKUP_CODE = 'hon_hsdm' 
			LEFT JOIN CMN_LOOKUPS_V STAGE_RPT ON STAGE_RPT.LOOKUP_CODE = STATUS_RPT.hon_fase_atual AND STAGE_RPT.LANGUAGE_CODE = 'pt' AND STAGE_RPT.LOOKUP_TYPE = 'HON_LKP_FASE_PROJETO'
			LEFT JOIN ODF_CA_HON_TESTES TESTES ON TESTES.ODF_PARENT_ID = INVI.ID
		WHERE 
			PFMP.ID = $P{portfolio} 
			AND INVI.ODF_OBJECT_CODE = 'project'
			AND TESTES.hon_fase_testes = 'hon_lkp_homologacao'
			AND $X{IN,STAGE_RPT.NAME,fase}
		)

		UNION

		SELECT
		TESTE,
		ISSUE,
		CASE
			WHEN FASE_SR IS NULL THEN FASE_PRJ
			ELSE FASE_SR
			END FASE,
		OWNER
		FROM
		(
			SELECT 
			0 TESTE
			, 1 ISSUE
			, STAGE.NAME FASE_PRJ
			, CASE
				WHEN (STATUS_RPT.COP_REPORT_STATUS = 'FINAL' AND STATUS_RPT.HON_TIPO_REL_STATUS = 'mensal')
				THEN STAGE_RPT.NAME
				ELSE NULL
				END FASE_SR
			, CASE 
				WHEN OWNER.NAME LIKE 'S - CS' THEN 'CS' 
				WHEN OWNER.NAME LIKE 'S - PARTS' THEN 'SP' 
				WHEN OWNER.NAME LIKE 'EDB - HDA' THEN 'EDB - HDA' 
				WHEN OWNER.NAME LIKE 'HAB - BR - E' THEN 'HAB - E' 
				WHEN OWNER.NAME LIKE 'HAB - BR - DB' THEN 'HAB - DB'		
				WHEN SUBSTR(OWNER.NAME,0,INSTR(OWNER.NAME,' ')-1) = 'TI' THEN 'IT' 
				ELSE SUBSTR(OWNER.NAME,0,INSTR(OWNER.NAME,' ')-1) 
				END OWNER			
		FROM 
			INV_INVESTMENTS INVI
			LEFT JOIN ODF_CA_INV OCINV ON INVI.ID = OCINV.ID
			LEFT JOIN CMN_LOOKUPS_V STATUS ON STATUS.LOOKUP_CODE = OCINV.hon_status AND STATUS.LANGUAGE_CODE = 'pt' AND STATUS.LOOKUP_TYPE = 'HON_STATUS_INVESTIMENTO'
			LEFT JOIN CMN_LOOKUPS_V STAGE_ATU ON INVI.STAGE_CODE = STAGE_ATU.LOOKUP_CODE AND   STAGE_ATU.LANGUAGE_CODE = 'pt' AND STAGE_ATU.LOOKUP_TYPE = 'INV_STAGE_TYPE' AND STAGE_ATU.PARENT_LOOKUP_CODE = 'hon_hsdm'
			LEFT JOIN CMN_LOOKUPS_V OWNER ON OWNER.LOOKUP_CODE = OCINV.hon_area AND OWNER.LANGUAGE_CODE = 'pt' AND OWNER.LOOKUP_TYPE = 'HON_LKP_AREA'
				LEFT JOIN (SELECT MAX(ID) MAX_ID, ODF_PARENT_ID INV_ID FROM odf_ca_cop_prj_statusrpt WHERE TRUNC(COP_REPORT_DATE,'MONTH') <= TRUNC(ADD_MONTHS($P{data_referencia},-1),'MONTH') AND COP_REPORT_STATUS = 'FINAL' AND HON_TIPO_REL_STATUS = 'mensal' GROUP BY ODF_PARENT_ID) MAX_REPORT ON MAX_REPORT.INV_ID = INVI.ID
				LEFT JOIN odf_ca_cop_prj_statusrpt STATUS_RPT ON MAX_REPORT.MAX_ID = STATUS_RPT.ID 
			LEFT JOIN PFM_INVESTMENTS PFMI ON PFMI.INVESTMENT_ID = INVI.ID
			LEFT JOIN PFM_PORTFOLIOS PFMP ON PFMI.PORTFOLIO_ID = PFMP.ID
			LEFT JOIN (SELECT MAX(ID) MAX_AUDIT, OBJECT_ID INV_ID from cmn_audits where ATTRIBUTE_CODE = 'stage_code' AND  LAST_UPDATED_DATE <= TRUNC(ADD_MONTHS($P{data_referencia},-1),'MONTH') GROUP BY OBJECT_ID) MAX_AUDIT ON MAX_AUDIT.INV_ID = INVI.ID
			LEFT JOIN CMN_AUDITS AUD ON AUD.ID = MAX_AUDIT.MAX_AUDIT
			LEFT JOIN CMN_LOOKUPS_V STAGE ON AUD.RAW_VALUE_AFTER = STAGE.LOOKUP_CODE AND   STAGE.LANGUAGE_CODE = 'pt' AND STAGE.LOOKUP_TYPE = 'INV_STAGE_TYPE' AND STAGE.PARENT_LOOKUP_CODE = 'hon_hsdm' 
			LEFT JOIN CMN_LOOKUPS_V STAGE_RPT ON STAGE_RPT.LOOKUP_CODE = STATUS_RPT.hon_fase_atual AND STAGE_RPT.LANGUAGE_CODE = 'pt' AND STAGE_RPT.LOOKUP_TYPE = 'HON_LKP_FASE_PROJETO'
			LEFT JOIN RIM_RISKS_AND_ISSUES ISSUE ON ISSUE.PK_ID = INVI.ID
			LEFT JOIN ODF_CA_ISSUE OCI ON ISSUE.ID = OCI.ID
		WHERE 
			PFMP.ID = $P{portfolio} 
			AND INVI.ODF_OBJECT_CODE = 'project'
			AND ISSUE.TYPE_CODE = 'ISSUE'
			AND OCI.hon_fase_testes = 'hon_lkp_homologacao'
		)

	)
	WHERE 
		$X{IN,OWNER,owner}
		AND $X{IN,FASE,fase}

	UNION

	SELECT 
		0 TOTAL
		, 0 QTD_KPI
		, 0 PCT_KPI
		, HON_META TARGET_PCT
		, HON_TIPO_META
		, 4 ORDEM
	FROM
		ODF_CA_HON_META META
	WHERE 
		META.hon_tipo_meta = 'issues_j5_req'
		AND META.HON_DATA_INI = (SELECT MAX(HON_DATA_INI) FROM ODF_CA_HON_META WHERE HON_TIPO_META = 'issues_j5_req' AND HON_DATA_INI <= TRUNC(ADD_MONTHS($P{data_referencia},-1),'MONTH'))

) KPI
JOIN CMN_LOOKUPS_V TIPO ON TIPO.LOOKUP_TYPE = 'HON_LKP_TIPOS_META' AND TIPO.LOOKUP_CODE = KPI.TIPO AND TIPO.LANGUAGE_CODE = 'pt'

GROUP BY
TIPO.NAME


UNION ALL

SELECT 
TIPO.NAME META
, SUM(TOTAL) TOTAL
, SUM(QTD_KPI) QTD_KPI
, ROUND(SUM(PCT_KPI),2) PCT_KPI
, SUM(TARGET) TARGET
, SUM(TARGET) - SUM(PCT_KPI) EVAL
, CASE
	WHEN (SUM(TARGET)-SUM(PCT_KPI)) <= 0.80 THEN 1
	WHEN (SUM(TARGET)-SUM(PCT_KPI)) > 0.80 AND (SUM(TARGET)-SUM(PCT_KPI)) <= 0.94 THEN 2
	WHEN (SUM(TARGET)-SUM(PCT_KPI)) > 0.94 AND (SUM(TARGET)-SUM(PCT_KPI)) <= 1.05 THEN 3
	WHEN (SUM(TARGET)-SUM(PCT_KPI)) > 1.05 AND (SUM(TARGET)-SUM(PCT_KPI)) <= 1.19 THEN 4
	WHEN (SUM(TARGET)-SUM(PCT_KPI)) > 1.19 THEN 5
	END EVAL_ID
FROM

(
	SELECT
	SUM(TESTE) TOTAL
	, SUM(ISSUE) QTD_KPI
	, SUM(ISSUE)/SUM(TESTE) PCT_KPI
	, 0 TARGET
	, 'issues_ao_req' TIPO
	, 5  ORDEM
	FROM
	(
		SELECT
		TESTE,
		ISSUE,
		CASE
			WHEN FASE_SR IS NULL THEN FASE_PRJ
			ELSE FASE_SR
			END FASE,
		OWNER
		FROM
		(
			SELECT 
				1 TESTE
				, 0 ISSUE
				, STAGE.NAME FASE_PRJ
				, CASE
					WHEN (STATUS_RPT.COP_REPORT_STATUS = 'FINAL' AND STATUS_RPT.HON_TIPO_REL_STATUS = 'mensal')
					THEN STAGE_RPT.NAME
					ELSE NULL
					END FASE_SR
				, CASE 
					WHEN OWNER.NAME LIKE 'S - CS' THEN 'CS' 
					WHEN OWNER.NAME LIKE 'S - PARTS' THEN 'SP' 
					WHEN OWNER.NAME LIKE 'EDB - HDA' THEN 'EDB - HDA' 
					WHEN OWNER.NAME LIKE 'HAB - BR - E' THEN 'HAB - E' 
					WHEN OWNER.NAME LIKE 'HAB - BR - DB' THEN 'HAB - DB'		
					WHEN SUBSTR(OWNER.NAME,0,INSTR(OWNER.NAME,' ')-1) = 'TI' THEN 'IT' 
					ELSE SUBSTR(OWNER.NAME,0,INSTR(OWNER.NAME,' ')-1) 
					END OWNER					
			FROM 
				INV_INVESTMENTS INVI
				LEFT JOIN ODF_CA_INV OCINV ON INVI.ID = OCINV.ID
				LEFT JOIN CMN_LOOKUPS_V STATUS ON STATUS.LOOKUP_CODE = OCINV.hon_status AND STATUS.LANGUAGE_CODE = 'pt' AND STATUS.LOOKUP_TYPE = 'HON_STATUS_INVESTIMENTO'
				LEFT JOIN CMN_LOOKUPS_V STAGE_ATU ON INVI.STAGE_CODE = STAGE_ATU.LOOKUP_CODE AND   STAGE_ATU.LANGUAGE_CODE = 'pt' AND STAGE_ATU.LOOKUP_TYPE = 'INV_STAGE_TYPE' AND STAGE_ATU.PARENT_LOOKUP_CODE = 'hon_hsdm'
				LEFT JOIN CMN_LOOKUPS_V OWNER ON OWNER.LOOKUP_CODE = OCINV.hon_area AND OWNER.LANGUAGE_CODE = 'pt' AND OWNER.LOOKUP_TYPE = 'HON_LKP_AREA'
				LEFT JOIN (SELECT MAX(ID) MAX_ID, ODF_PARENT_ID INV_ID FROM odf_ca_cop_prj_statusrpt WHERE TRUNC(COP_REPORT_DATE,'MONTH') <= TRUNC(ADD_MONTHS($P{data_referencia},-1),'MONTH') AND COP_REPORT_STATUS = 'FINAL' AND HON_TIPO_REL_STATUS = 'mensal' GROUP BY ODF_PARENT_ID) MAX_REPORT ON MAX_REPORT.INV_ID = INVI.ID
				LEFT JOIN odf_ca_cop_prj_statusrpt STATUS_RPT ON MAX_REPORT.MAX_ID = STATUS_RPT.ID 
				LEFT JOIN PFM_INVESTMENTS PFMI ON PFMI.INVESTMENT_ID = INVI.ID
				LEFT JOIN PFM_PORTFOLIOS PFMP ON PFMI.PORTFOLIO_ID = PFMP.ID
				LEFT JOIN (SELECT MAX(ID) MAX_AUDIT, OBJECT_ID INV_ID from cmn_audits where ATTRIBUTE_CODE = 'stage_code' AND  LAST_UPDATED_DATE <= TRUNC(ADD_MONTHS($P{data_referencia},-1),'MONTH') GROUP BY OBJECT_ID) MAX_AUDIT ON MAX_AUDIT.INV_ID = INVI.ID
				LEFT JOIN CMN_AUDITS AUD ON AUD.ID = MAX_AUDIT.MAX_AUDIT
				LEFT JOIN CMN_LOOKUPS_V STAGE ON AUD.RAW_VALUE_AFTER = STAGE.LOOKUP_CODE AND   STAGE.LANGUAGE_CODE = 'pt' AND STAGE.LOOKUP_TYPE = 'INV_STAGE_TYPE' AND STAGE.PARENT_LOOKUP_CODE = 'hon_hsdm' 
				LEFT JOIN CMN_LOOKUPS_V STAGE_RPT ON STAGE_RPT.LOOKUP_CODE = STATUS_RPT.hon_fase_atual AND STAGE_RPT.LANGUAGE_CODE = 'pt' AND STAGE_RPT.LOOKUP_TYPE = 'HON_LKP_FASE_PROJETO'
				LEFT JOIN ODF_CA_HON_TESTES TESTES ON TESTES.ODF_PARENT_ID = INVI.ID
			WHERE 
				PFMP.ID = $P{portfolio} 
				AND INVI.ODF_OBJECT_CODE = 'project'
				AND TESTES.hon_fase_testes = 'hon_lkp_operacao_assistida'
		)

		UNION

		SELECT
		TESTE,
		ISSUE,
		CASE
			WHEN FASE_SR IS NULL THEN FASE_PRJ
			ELSE FASE_SR
			END FASE,
		OWNER
		FROM
		(
			SELECT 
				0 TESTE
				, 1 ISSUE
				, STAGE.NAME FASE_PRJ
				, CASE
					WHEN (STATUS_RPT.COP_REPORT_STATUS = 'FINAL' AND STATUS_RPT.HON_TIPO_REL_STATUS = 'mensal')
					THEN STAGE_RPT.NAME
					ELSE NULL
					END FASE_SR
				, CASE 
					WHEN OWNER.NAME LIKE 'S - CS' THEN 'CS' 
					WHEN OWNER.NAME LIKE 'S - PARTS' THEN 'SP' 
					WHEN OWNER.NAME LIKE 'EDB - HDA' THEN 'EDB - HDA' 
					WHEN OWNER.NAME LIKE 'HAB - BR - E' THEN 'HAB - E' 
					WHEN OWNER.NAME LIKE 'HAB - BR - DB' THEN 'HAB - DB'		
					WHEN SUBSTR(OWNER.NAME,0,INSTR(OWNER.NAME,' ')-1) = 'TI' THEN 'IT' 
					ELSE SUBSTR(OWNER.NAME,0,INSTR(OWNER.NAME,' ')-1) 
					END OWNER				
			FROM 
				INV_INVESTMENTS INVI
				LEFT JOIN ODF_CA_INV OCINV ON INVI.ID = OCINV.ID
				LEFT JOIN CMN_LOOKUPS_V STATUS ON STATUS.LOOKUP_CODE = OCINV.hon_status AND STATUS.LANGUAGE_CODE = 'pt' AND STATUS.LOOKUP_TYPE = 'HON_STATUS_INVESTIMENTO'
				LEFT JOIN CMN_LOOKUPS_V STAGE_ATU ON INVI.STAGE_CODE = STAGE_ATU.LOOKUP_CODE AND   STAGE_ATU.LANGUAGE_CODE = 'pt' AND STAGE_ATU.LOOKUP_TYPE = 'INV_STAGE_TYPE' AND STAGE_ATU.PARENT_LOOKUP_CODE = 'hon_hsdm'
				LEFT JOIN CMN_LOOKUPS_V OWNER ON OWNER.LOOKUP_CODE = OCINV.hon_area AND OWNER.LANGUAGE_CODE = 'pt' AND OWNER.LOOKUP_TYPE = 'HON_LKP_AREA'
				LEFT JOIN (SELECT MAX(ID) MAX_ID, ODF_PARENT_ID INV_ID FROM odf_ca_cop_prj_statusrpt WHERE TRUNC(COP_REPORT_DATE,'MONTH') <= TRUNC(ADD_MONTHS($P{data_referencia},-1),'MONTH') AND COP_REPORT_STATUS = 'FINAL' AND HON_TIPO_REL_STATUS = 'mensal' GROUP BY ODF_PARENT_ID) MAX_REPORT ON MAX_REPORT.INV_ID = INVI.ID
				LEFT JOIN odf_ca_cop_prj_statusrpt STATUS_RPT ON MAX_REPORT.MAX_ID = STATUS_RPT.ID 
				LEFT JOIN PFM_INVESTMENTS PFMI ON PFMI.INVESTMENT_ID = INVI.ID
				LEFT JOIN PFM_PORTFOLIOS PFMP ON PFMI.PORTFOLIO_ID = PFMP.ID
				LEFT JOIN (SELECT MAX(ID) MAX_AUDIT, OBJECT_ID INV_ID from cmn_audits where ATTRIBUTE_CODE = 'stage_code' AND  LAST_UPDATED_DATE <= TRUNC(ADD_MONTHS($P{data_referencia},-1),'MONTH') GROUP BY OBJECT_ID) MAX_AUDIT ON MAX_AUDIT.INV_ID = INVI.ID
				LEFT JOIN CMN_AUDITS AUD ON AUD.ID = MAX_AUDIT.MAX_AUDIT
				LEFT JOIN CMN_LOOKUPS_V STAGE ON AUD.RAW_VALUE_AFTER = STAGE.LOOKUP_CODE AND   STAGE.LANGUAGE_CODE = 'pt' AND STAGE.LOOKUP_TYPE = 'INV_STAGE_TYPE' AND STAGE.PARENT_LOOKUP_CODE = 'hon_hsdm' 
				LEFT JOIN CMN_LOOKUPS_V STAGE_RPT ON STAGE_RPT.LOOKUP_CODE = STATUS_RPT.hon_fase_atual AND STAGE_RPT.LANGUAGE_CODE = 'pt' AND STAGE_RPT.LOOKUP_TYPE = 'HON_LKP_FASE_PROJETO'
				LEFT JOIN RIM_RISKS_AND_ISSUES ISSUE ON ISSUE.PK_ID = INVI.ID
				LEFT JOIN ODF_CA_ISSUE OCI ON ISSUE.ID = OCI.ID
			WHERE 
				PFMP.ID = $P{portfolio} 
				AND INVI.ODF_OBJECT_CODE = 'project'
				AND ISSUE.TYPE_CODE = 'ISSUE'
				AND OCI.HON_FASE_TESTES = 'hon_lkp_operacao_assistida'
		)

	)
	WHERE 
		$X{IN,OWNER,owner}
		AND $X{IN,FASE,fase}
	UNION

	SELECT 
		0 TOTAL
		, 0 QTD_KPI
		, 0 PCT_KPI
		, HON_META TARGET_PCT
		, HON_TIPO_META
		, 5 ORDEM
	FROM
		ODF_CA_HON_META META
	WHERE 
		META.hon_tipo_meta = 'issues_ao_req'
		AND META.HON_DATA_INI = (SELECT MAX(HON_DATA_INI) FROM ODF_CA_HON_META WHERE HON_TIPO_META = 'issues_j5_req' AND HON_DATA_INI <= TRUNC(ADD_MONTHS($P{data_referencia},-1),'MONTH'))

) KPI
JOIN CMN_LOOKUPS_V TIPO ON TIPO.LOOKUP_TYPE = 'HON_LKP_TIPOS_META' AND TIPO.LOOKUP_CODE = KPI.TIPO AND TIPO.LANGUAGE_CODE = 'pt'

GROUP BY
TIPO.NAME]]>
		</queryString>
		<field name="META" class="java.lang.String"/>
		<field name="TOTAL" class="java.math.BigDecimal"/>
		<field name="QTD_KPI" class="java.math.BigDecimal"/>
		<field name="PCT_KPI" class="java.math.BigDecimal"/>
		<field name="TARGET" class="java.math.BigDecimal"/>
		<field name="EVAL" class="java.math.BigDecimal"/>
		<field name="EVAL_ID" class="java.math.BigDecimal"/>
	</subDataset>
	<subDataset name="changes_kpi" uuid="eb459199-5499-447a-baf7-de5bfa67619e">
		<property name="com.jaspersoft.studio.data.defaultdataadapter" value="HONDA - PRD"/>
		<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
		<property name="com.jaspersoft.studio.data.sql.SQLQueryDesigner.sash.w1" value="0"/>
		<property name="com.jaspersoft.studio.data.sql.SQLQueryDesigner.sash.w2" value="1000"/>
		<parameter name="data_referencia" class="java.util.Date"/>
		<parameter name="owner" class="java.util.Collection"/>
		<parameter name="portfolio" class="java.lang.String"/>
		<parameter name="fase" class="java.util.Collection"/>
		<queryString>
			<![CDATA[SELECT 
TIPO.NAME META,
SUM(TOTAL) TOTAL,
SUM(QTD_KPI) QTD_KPI,
ROUND(SUM(PCT_KPI),2) PCT_KPI,
SUM(TARGET) TARGET,
SUM(TARGET) - SUM(PCT_KPI) EVAL,
CASE
	WHEN (SUM(TARGET)-SUM(PCT_KPI)) <= 0.80 THEN 1
	WHEN (SUM(TARGET)-SUM(PCT_KPI)) > 0.80 AND (SUM(TARGET)-SUM(PCT_KPI)) <= 0.94 THEN 2
	WHEN (SUM(TARGET)-SUM(PCT_KPI)) > 0.94 AND (SUM(TARGET)-SUM(PCT_KPI)) <= 1.05 THEN 3
	WHEN (SUM(TARGET)-SUM(PCT_KPI)) > 1.05 AND (SUM(TARGET)-SUM(PCT_KPI)) <= 1.19 THEN 4
	WHEN (SUM(TARGET)-SUM(PCT_KPI)) > 1.19 THEN 5
	END EVAL_ID
FROM

(
	SELECT
	SUM(REQUISITO) TOTAL,
	SUM(CHANGE) QTD_KPI,
	CASE WHEN SUM(REQUISITO) > 0 AND SUM(CHANGE) > 0 THEN SUM(CHANGE)/SUM(REQUISITO) ELSE 0 END PCT_KPI,
	NULL TARGET,
	'scope_changes_req_j0' TIPO,
	6 ORDEM
	FROM
	(
		SELECT 
			1 REQUISITO,
			0 CHANGE,
			CASE 
				WHEN OWNER.NAME LIKE 'S - CS' THEN 'CS' 
				WHEN OWNER.NAME LIKE 'S - PARTS' THEN 'SP' 
				WHEN SUBSTR(OWNER.NAME,0,INSTR(OWNER.NAME,' ')-1) = 'TI' THEN 'IT' 
				ELSE SUBSTR(OWNER.NAME,0,INSTR(OWNER.NAME,' ')-1) 
				END OWNER
		FROM 
			INV_INVESTMENTS INVI
			JOIN ODF_CA_INV OCINV ON INVI.ID = OCINV.ID
			LEFT JOIN CMN_LOOKUPS_V STATUS ON STATUS.LOOKUP_CODE = OCINV.hon_status AND STATUS.LANGUAGE_CODE = 'pt' AND STATUS.LOOKUP_TYPE = 'HON_STATUS_INVESTIMENTO'
			JOIN CMN_LOOKUPS_V STAGE_ATU ON INVI.STAGE_CODE = STAGE_ATU.LOOKUP_CODE AND   STAGE_ATU.LANGUAGE_CODE = 'pt' AND STAGE_ATU.LOOKUP_TYPE = 'INV_STAGE_TYPE' AND STAGE_ATU.PARENT_LOOKUP_CODE = 'hon_hsdm'
			JOIN CMN_LOOKUPS_V OWNER ON OWNER.LOOKUP_CODE = OCINV.hon_area AND OWNER.LANGUAGE_CODE = 'pt' AND OWNER.LOOKUP_TYPE = 'HON_LKP_AREA'
				LEFT JOIN (SELECT MAX(ID) MAX_ID, ODF_PARENT_ID INV_ID FROM odf_ca_cop_prj_statusrpt WHERE TRUNC(COP_REPORT_DATE,'MONTH') <= TRUNC(ADD_MONTHS($P{data_referencia},-1),'MONTH') AND COP_REPORT_STATUS = 'FINAL' AND HON_TIPO_REL_STATUS = 'mensal' GROUP BY ODF_PARENT_ID) MAX_REPORT ON MAX_REPORT.INV_ID = INVI.ID
				LEFT JOIN odf_ca_cop_prj_statusrpt STATUS_RPT ON MAX_REPORT.MAX_ID = STATUS_RPT.ID 
			LEFT JOIN PFM_INVESTMENTS PFMI ON PFMI.INVESTMENT_ID = INVI.ID
			LEFT JOIN PFM_PORTFOLIOS PFMP ON PFMI.PORTFOLIO_ID = PFMP.ID
			LEFT JOIN (SELECT MAX(ID) MAX_AUDIT, OBJECT_ID INV_ID from cmn_audits where ATTRIBUTE_CODE = 'stage_code' AND  LAST_UPDATED_DATE <= TRUNC(ADD_MONTHS($P{data_referencia},-1),'MONTH') GROUP BY OBJECT_ID) MAX_AUDIT ON MAX_AUDIT.INV_ID = INVI.ID
			LEFT JOIN CMN_AUDITS AUD ON AUD.ID = MAX_AUDIT.MAX_AUDIT
			LEFT JOIN CMN_LOOKUPS_V STAGE ON AUD.RAW_VALUE_AFTER = STAGE.LOOKUP_CODE AND   STAGE.LANGUAGE_CODE = 'pt' AND STAGE.LOOKUP_TYPE = 'INV_STAGE_TYPE' AND STAGE.PARENT_LOOKUP_CODE = 'hon_hsdm' 
			LEFT JOIN CMN_LOOKUPS_V STAGE_RPT ON STAGE_RPT.LOOKUP_CODE = STATUS_RPT.hon_fase_atual AND STAGE_RPT.LANGUAGE_CODE = 'pt' AND STAGE_RPT.LOOKUP_TYPE = 'HON_LKP_FASE_PROJETO'
			JOIN ODF_CA_HON_REQUISITOS REQ ON INVI.ID = REQ.ODF_PARENT_ID
		WHERE 
			PFMP.ID = $P{portfolio} 
			AND INVI.ODF_OBJECT_CODE = 'project'
			AND (REQ.hon_fase_inclusao IN ('hon_lkp_u0','hon_lkp_u1','hon_lkp_j0') AND REQ.hon_fase_cancel IS NULL)
			AND $X{IN,STAGE_RPT.NAME,fase}

		UNION

		SELECT 
			0 REQUISITO,
			1 CHANGE,
				CASE 
				WHEN OWNER.NAME LIKE 'S - CS' THEN 'CS' 
				WHEN OWNER.NAME LIKE 'S - PARTS' THEN 'SP' 
				WHEN OWNER.NAME LIKE 'EDB - HDA' THEN 'EDB - HDA' 
				WHEN OWNER.NAME LIKE 'HAB - BR - E' THEN 'HAB - E' 
				WHEN OWNER.NAME LIKE 'HAB - BR - DB' THEN 'HAB - DB'		
				WHEN SUBSTR(OWNER.NAME,0,INSTR(OWNER.NAME,' ')-1) = 'TI' THEN 'IT' 
				ELSE SUBSTR(OWNER.NAME,0,INSTR(OWNER.NAME,' ')-1) 
				END OWNER
		FROM 
			INV_INVESTMENTS INVI
			JOIN ODF_CA_INV OCINV ON INVI.ID = OCINV.ID
			LEFT JOIN CMN_LOOKUPS_V STATUS ON STATUS.LOOKUP_CODE = OCINV.hon_status AND STATUS.LANGUAGE_CODE = 'pt' AND STATUS.LOOKUP_TYPE = 'HON_STATUS_INVESTIMENTO'
			JOIN CMN_LOOKUPS_V STAGE_ATU ON INVI.STAGE_CODE = STAGE_ATU.LOOKUP_CODE AND   STAGE_ATU.LANGUAGE_CODE = 'pt' AND STAGE_ATU.LOOKUP_TYPE = 'INV_STAGE_TYPE' AND STAGE_ATU.PARENT_LOOKUP_CODE = 'hon_hsdm'
			JOIN CMN_LOOKUPS_V OWNER ON OWNER.LOOKUP_CODE = OCINV.hon_area AND OWNER.LANGUAGE_CODE = 'pt' AND OWNER.LOOKUP_TYPE = 'HON_LKP_AREA'
				LEFT JOIN (SELECT MAX(ID) MAX_ID, ODF_PARENT_ID INV_ID FROM odf_ca_cop_prj_statusrpt WHERE TRUNC(COP_REPORT_DATE,'MONTH') <= TRUNC(ADD_MONTHS($P{data_referencia},-1),'MONTH') AND COP_REPORT_STATUS = 'FINAL' AND HON_TIPO_REL_STATUS = 'mensal' GROUP BY ODF_PARENT_ID) MAX_REPORT ON MAX_REPORT.INV_ID = INVI.ID
				LEFT JOIN odf_ca_cop_prj_statusrpt STATUS_RPT ON MAX_REPORT.MAX_ID = STATUS_RPT.ID 
			LEFT JOIN PFM_INVESTMENTS PFMI ON PFMI.INVESTMENT_ID = INVI.ID
			LEFT JOIN PFM_PORTFOLIOS PFMP ON PFMI.PORTFOLIO_ID = PFMP.ID
			LEFT JOIN (SELECT MAX(ID) MAX_AUDIT, OBJECT_ID INV_ID from cmn_audits where ATTRIBUTE_CODE = 'stage_code' AND  LAST_UPDATED_DATE <= TRUNC(ADD_MONTHS($P{data_referencia},-1),'MONTH') GROUP BY OBJECT_ID) MAX_AUDIT ON MAX_AUDIT.INV_ID = INVI.ID
			LEFT JOIN CMN_AUDITS AUD ON AUD.ID = MAX_AUDIT.MAX_AUDIT
			LEFT JOIN CMN_LOOKUPS_V STAGE ON AUD.RAW_VALUE_AFTER = STAGE.LOOKUP_CODE AND   STAGE.LANGUAGE_CODE = 'pt' AND STAGE.LOOKUP_TYPE = 'INV_STAGE_TYPE' AND STAGE.PARENT_LOOKUP_CODE = 'hon_hsdm' 
			LEFT JOIN CMN_LOOKUPS_V STAGE_RPT ON STAGE_RPT.LOOKUP_CODE = STATUS_RPT.hon_fase_atual AND STAGE_RPT.LANGUAGE_CODE = 'pt' AND STAGE_RPT.LOOKUP_TYPE = 'HON_LKP_FASE_PROJETO'
			JOIN ODF_CA_HON_REQUISITOS OCREQ ON INVI.ID = OCREQ.ODF_PARENT_ID
		WHERE 
			PFMP.ID = $P{portfolio} 
			AND INVI.ODF_OBJECT_CODE = 'project'
			AND OCREQ.hon_fase_inclusao IN ('hon_lkp_u0','hon_lkp_u1','hon_lkp_j0')
			AND $X{IN,STAGE_RPT.NAME,fase}
		
		UNION ALL

		SELECT 
			0 REQUISITO,
			1 CHANGE,
				CASE 
				WHEN OWNER.NAME LIKE 'S - CS' THEN 'CS' 
				WHEN OWNER.NAME LIKE 'S - PARTS' THEN 'SP' 
				WHEN OWNER.NAME LIKE 'EDB - HDA' THEN 'EDB - HDA' 
				WHEN OWNER.NAME LIKE 'HAB - BR - E' THEN 'HAB - E' 
				WHEN OWNER.NAME LIKE 'HAB - BR - DB' THEN 'HAB - DB'		
				WHEN SUBSTR(OWNER.NAME,0,INSTR(OWNER.NAME,' ')-1) = 'TI' THEN 'IT' 
				ELSE SUBSTR(OWNER.NAME,0,INSTR(OWNER.NAME,' ')-1) 
				END OWNER
		FROM 
			INV_INVESTMENTS INVI
			JOIN ODF_CA_INV OCINV ON INVI.ID = OCINV.ID
			LEFT JOIN CMN_LOOKUPS_V STATUS ON STATUS.LOOKUP_CODE = OCINV.hon_status AND STATUS.LANGUAGE_CODE = 'pt' AND STATUS.LOOKUP_TYPE = 'HON_STATUS_INVESTIMENTO'
			JOIN CMN_LOOKUPS_V STAGE_ATU ON INVI.STAGE_CODE = STAGE_ATU.LOOKUP_CODE AND   STAGE_ATU.LANGUAGE_CODE = 'pt' AND STAGE_ATU.LOOKUP_TYPE = 'INV_STAGE_TYPE' AND STAGE_ATU.PARENT_LOOKUP_CODE = 'hon_hsdm'
			JOIN CMN_LOOKUPS_V OWNER ON OWNER.LOOKUP_CODE = OCINV.hon_area AND OWNER.LANGUAGE_CODE = 'pt' AND OWNER.LOOKUP_TYPE = 'HON_LKP_AREA'
				LEFT JOIN (SELECT MAX(ID) MAX_ID, ODF_PARENT_ID INV_ID FROM odf_ca_cop_prj_statusrpt WHERE TRUNC(COP_REPORT_DATE,'MONTH') <= TRUNC(ADD_MONTHS($P{data_referencia},-1),'MONTH') AND COP_REPORT_STATUS = 'FINAL' AND HON_TIPO_REL_STATUS = 'mensal' GROUP BY ODF_PARENT_ID) MAX_REPORT ON MAX_REPORT.INV_ID = INVI.ID
				LEFT JOIN odf_ca_cop_prj_statusrpt STATUS_RPT ON MAX_REPORT.MAX_ID = STATUS_RPT.ID 
			LEFT JOIN PFM_INVESTMENTS PFMI ON PFMI.INVESTMENT_ID = INVI.ID
			LEFT JOIN PFM_PORTFOLIOS PFMP ON PFMI.PORTFOLIO_ID = PFMP.ID
			LEFT JOIN (SELECT MAX(ID) MAX_AUDIT, OBJECT_ID INV_ID from cmn_audits where ATTRIBUTE_CODE = 'stage_code' AND  LAST_UPDATED_DATE <= TRUNC(ADD_MONTHS($P{data_referencia},-1),'MONTH') GROUP BY OBJECT_ID) MAX_AUDIT ON MAX_AUDIT.INV_ID = INVI.ID
			LEFT JOIN CMN_AUDITS AUD ON AUD.ID = MAX_AUDIT.MAX_AUDIT
			LEFT JOIN CMN_LOOKUPS_V STAGE ON AUD.RAW_VALUE_AFTER = STAGE.LOOKUP_CODE AND   STAGE.LANGUAGE_CODE = 'pt' AND STAGE.LOOKUP_TYPE = 'INV_STAGE_TYPE' AND STAGE.PARENT_LOOKUP_CODE = 'hon_hsdm' 
			LEFT JOIN CMN_LOOKUPS_V STAGE_RPT ON STAGE_RPT.LOOKUP_CODE = STATUS_RPT.hon_fase_atual AND STAGE_RPT.LANGUAGE_CODE = 'pt' AND STAGE_RPT.LOOKUP_TYPE = 'HON_LKP_FASE_PROJETO'
			JOIN ODF_CA_HON_REQUISITOS OCREQ ON INVI.ID = OCREQ.ODF_PARENT_ID
		WHERE 
			PFMP.ID = $P{portfolio} 
			AND INVI.ODF_OBJECT_CODE = 'project'
			AND OCREQ.hon_fase_cancel IN ('hon_lkp_u0','hon_lkp_u1','hon_lkp_j0')
			AND $X{IN,STAGE_RPT.NAME,fase}
		
		UNION ALL

		SELECT 
			0 REQUISITO,
			1 CHANGE,
				CASE 
				WHEN OWNER.NAME LIKE 'S - CS' THEN 'CS' 
				WHEN OWNER.NAME LIKE 'S - PARTS' THEN 'SP' 
				WHEN OWNER.NAME LIKE 'EDB - HDA' THEN 'EDB - HDA' 
				WHEN OWNER.NAME LIKE 'HAB - BR - E' THEN 'HAB - E' 
				WHEN OWNER.NAME LIKE 'HAB - BR - DB' THEN 'HAB - DB'		
				WHEN SUBSTR(OWNER.NAME,0,INSTR(OWNER.NAME,' ')-1) = 'TI' THEN 'IT' 
				ELSE SUBSTR(OWNER.NAME,0,INSTR(OWNER.NAME,' ')-1) 
				END OWNER
		FROM 
			INV_INVESTMENTS INVI
			JOIN ODF_CA_INV OCINV ON INVI.ID = OCINV.ID
			LEFT JOIN CMN_LOOKUPS_V STATUS ON STATUS.LOOKUP_CODE = OCINV.hon_status AND STATUS.LANGUAGE_CODE = 'pt' AND STATUS.LOOKUP_TYPE = 'HON_STATUS_INVESTIMENTO'
			JOIN CMN_LOOKUPS_V STAGE_ATU ON INVI.STAGE_CODE = STAGE_ATU.LOOKUP_CODE AND   STAGE_ATU.LANGUAGE_CODE = 'pt' AND STAGE_ATU.LOOKUP_TYPE = 'INV_STAGE_TYPE' AND STAGE_ATU.PARENT_LOOKUP_CODE = 'hon_hsdm'
			JOIN CMN_LOOKUPS_V OWNER ON OWNER.LOOKUP_CODE = OCINV.hon_area AND OWNER.LANGUAGE_CODE = 'pt' AND OWNER.LOOKUP_TYPE = 'HON_LKP_AREA'
				LEFT JOIN (SELECT MAX(ID) MAX_ID, ODF_PARENT_ID INV_ID FROM odf_ca_cop_prj_statusrpt WHERE TRUNC(COP_REPORT_DATE,'MONTH') <= TRUNC(ADD_MONTHS($P{data_referencia},-1),'MONTH') AND COP_REPORT_STATUS = 'FINAL' AND HON_TIPO_REL_STATUS = 'mensal' GROUP BY ODF_PARENT_ID) MAX_REPORT ON MAX_REPORT.INV_ID = INVI.ID
				LEFT JOIN odf_ca_cop_prj_statusrpt STATUS_RPT ON MAX_REPORT.MAX_ID = STATUS_RPT.ID 
			LEFT JOIN PFM_INVESTMENTS PFMI ON PFMI.INVESTMENT_ID = INVI.ID
			LEFT JOIN PFM_PORTFOLIOS PFMP ON PFMI.PORTFOLIO_ID = PFMP.ID
			LEFT JOIN (SELECT MAX(ID) MAX_AUDIT, OBJECT_ID INV_ID from cmn_audits where ATTRIBUTE_CODE = 'stage_code' AND  LAST_UPDATED_DATE <= TRUNC(ADD_MONTHS($P{data_referencia},-1),'MONTH') GROUP BY OBJECT_ID) MAX_AUDIT ON MAX_AUDIT.INV_ID = INVI.ID
			LEFT JOIN CMN_AUDITS AUD ON AUD.ID = MAX_AUDIT.MAX_AUDIT
			LEFT JOIN CMN_LOOKUPS_V STAGE ON AUD.RAW_VALUE_AFTER = STAGE.LOOKUP_CODE AND   STAGE.LANGUAGE_CODE = 'pt' AND STAGE.LOOKUP_TYPE = 'INV_STAGE_TYPE' AND STAGE.PARENT_LOOKUP_CODE = 'hon_hsdm' 
			LEFT JOIN CMN_LOOKUPS_V STAGE_RPT ON STAGE_RPT.LOOKUP_CODE = STATUS_RPT.hon_fase_atual AND STAGE_RPT.LANGUAGE_CODE = 'pt' AND STAGE_RPT.LOOKUP_TYPE = 'HON_LKP_FASE_PROJETO'
			JOIN ODF_CA_HON_REQUISITOS OCREQ ON INVI.ID = OCREQ.ODF_PARENT_ID
		WHERE 
			PFMP.ID = $P{portfolio} 
			AND INVI.ODF_OBJECT_CODE = 'project'
			AND OCREQ.hon_fase_alteracao IN ('hon_lkp_u0','hon_lkp_u1','hon_lkp_j0')
			AND $X{IN,STAGE_RPT.NAME,fase}
	)
	WHERE 
		$X{IN,OWNER,owner}

	UNION

	SELECT 
		0 TOTAL,
		0 QTD_KPI,
		0 PCT_KPI,
		HON_META TARGET_PCT,
		HON_TIPO_META,
		6 ORDEM
	FROM
		ODF_CA_HON_META META
	WHERE 
		META.hon_tipo_meta = 'scope_changes_req_j0'
		AND META.HON_DATA_INI = (SELECT MAX(HON_DATA_INI) FROM ODF_CA_HON_META WHERE HON_TIPO_META = 'scope_changes_req_j0' AND TRUNC(HON_DATA_INI,'MONTH') <= TRUNC($P{data_referencia} ,'MONTH')-1 )

) KPI
JOIN CMN_LOOKUPS_V TIPO ON TIPO.LOOKUP_TYPE = 'HON_LKP_TIPOS_META' AND TIPO.LOOKUP_CODE = KPI.TIPO AND TIPO.LANGUAGE_CODE = 'pt'

GROUP BY
TIPO.NAME

UNION ALL

SELECT 
TIPO.NAME META,
SUM(TOTAL) TOTAL,
SUM(QTD_KPI) QTD_KPI,
ROUND(SUM(PCT_KPI),2) PCT_KPI,
SUM(TARGET) TARGET,
SUM(TARGET) - SUM(PCT_KPI) EVAL,
CASE
	WHEN (SUM(TARGET)-SUM(PCT_KPI)) <= 0.80 THEN 1
	WHEN (SUM(TARGET)-SUM(PCT_KPI)) > 0.80 AND (SUM(TARGET)-SUM(PCT_KPI)) <= 0.94 THEN 2
	WHEN (SUM(TARGET)-SUM(PCT_KPI)) > 0.94 AND (SUM(TARGET)-SUM(PCT_KPI)) <= 1.05 THEN 3
	WHEN (SUM(TARGET)-SUM(PCT_KPI)) > 1.05 AND (SUM(TARGET)-SUM(PCT_KPI)) <= 1.19 THEN 4
	WHEN (SUM(TARGET)-SUM(PCT_KPI)) > 1.19 THEN 5
	END EVAL_ID
FROM
(
	SELECT
		SUM(REQUISITO) TOTAL,
		SUM(CHANGE) QTD_KPI,
		CASE WHEN SUM(REQUISITO) > 0 AND SUM(CHANGE) > 0 THEN SUM(CHANGE)/SUM(REQUISITO) ELSE 0 END PCT_KPI,
		NULL TARGET,
		'scope_changes_req' TIPO,
		7  ORDEM
	FROM
	(
		SELECT 
			CASE WHEN REQ.hon_fase_cancel IS NULL THEN 1 ELSE -1 END REQUISITO,
			0 CHANGE,
			CASE 
				WHEN OWNER.NAME LIKE 'S - CS' THEN 'CS' 
				WHEN OWNER.NAME LIKE 'S - PARTS' THEN 'SP' 
				WHEN OWNER.NAME LIKE 'EDB - HDA' THEN 'EDB - HDA' 
				WHEN OWNER.NAME LIKE 'HAB - BR - E' THEN 'HAB - E' 
				WHEN OWNER.NAME LIKE 'HAB - BR - DB' THEN 'HAB - DB'		
				WHEN SUBSTR(OWNER.NAME,0,INSTR(OWNER.NAME,' ')-1) = 'TI' THEN 'IT' 
				ELSE SUBSTR(OWNER.NAME,0,INSTR(OWNER.NAME,' ')-1) 
				END OWNER
		FROM 
			INV_INVESTMENTS INVI
			JOIN ODF_CA_INV OCINV ON INVI.ID = OCINV.ID
			LEFT JOIN CMN_LOOKUPS_V STATUS ON STATUS.LOOKUP_CODE = OCINV.hon_status AND STATUS.LANGUAGE_CODE = 'pt' AND STATUS.LOOKUP_TYPE = 'HON_STATUS_INVESTIMENTO'
			JOIN CMN_LOOKUPS_V STAGE_ATU ON INVI.STAGE_CODE = STAGE_ATU.LOOKUP_CODE AND   STAGE_ATU.LANGUAGE_CODE = 'pt' AND STAGE_ATU.LOOKUP_TYPE = 'INV_STAGE_TYPE' AND STAGE_ATU.PARENT_LOOKUP_CODE = 'hon_hsdm'
			JOIN CMN_LOOKUPS_V OWNER ON OWNER.LOOKUP_CODE = OCINV.hon_area AND OWNER.LANGUAGE_CODE = 'pt' AND OWNER.LOOKUP_TYPE = 'HON_LKP_AREA'
				LEFT JOIN (SELECT MAX(ID) MAX_ID, ODF_PARENT_ID INV_ID FROM odf_ca_cop_prj_statusrpt WHERE TRUNC(COP_REPORT_DATE,'MONTH') <= TRUNC(ADD_MONTHS($P{data_referencia},-1),'MONTH') AND COP_REPORT_STATUS = 'FINAL' AND HON_TIPO_REL_STATUS = 'mensal' GROUP BY ODF_PARENT_ID) MAX_REPORT ON MAX_REPORT.INV_ID = INVI.ID
				LEFT JOIN odf_ca_cop_prj_statusrpt STATUS_RPT ON MAX_REPORT.MAX_ID = STATUS_RPT.ID 
			LEFT JOIN PFM_INVESTMENTS PFMI ON PFMI.INVESTMENT_ID = INVI.ID
			LEFT JOIN PFM_PORTFOLIOS PFMP ON PFMI.PORTFOLIO_ID = PFMP.ID
			LEFT JOIN (SELECT MAX(ID) MAX_AUDIT, OBJECT_ID INV_ID from cmn_audits where ATTRIBUTE_CODE = 'stage_code' AND  LAST_UPDATED_DATE <= TRUNC(ADD_MONTHS($P{data_referencia},-1),'MONTH') GROUP BY OBJECT_ID) MAX_AUDIT ON MAX_AUDIT.INV_ID = INVI.ID
			LEFT JOIN CMN_AUDITS AUD ON AUD.ID = MAX_AUDIT.MAX_AUDIT
			LEFT JOIN CMN_LOOKUPS_V STAGE ON AUD.RAW_VALUE_AFTER = STAGE.LOOKUP_CODE AND   STAGE.LANGUAGE_CODE = 'pt' AND STAGE.LOOKUP_TYPE = 'INV_STAGE_TYPE' AND STAGE.PARENT_LOOKUP_CODE = 'hon_hsdm' 
			LEFT JOIN CMN_LOOKUPS_V STAGE_RPT ON STAGE_RPT.LOOKUP_CODE = STATUS_RPT.hon_fase_atual AND STAGE_RPT.LANGUAGE_CODE = 'pt' AND STAGE_RPT.LOOKUP_TYPE = 'HON_LKP_FASE_PROJETO'
			JOIN ODF_CA_HON_REQUISITOS REQ ON REQ.ODF_PARENT_ID = INVI.ID
		WHERE 
			PFMP.ID = $P{portfolio} 
			AND INVI.ODF_OBJECT_CODE = 'project'
			AND (REQ.hon_fase_inclusao IN ('hon_lkp_j1','hon_lkp_j2','hon_lkp_j3','hon_lkp_j4','hon_lkp_j5') AND REQ.hon_fase_cancel IS NULL)
			AND $X{IN,STAGE_RPT.NAME,fase}

		UNION

		SELECT 
			0 REQUISITO,
			1 CHANGE,
				CASE 
				WHEN OWNER.NAME LIKE 'S - CS' THEN 'CS' 
				WHEN OWNER.NAME LIKE 'S - PARTS' THEN 'SP' 
				WHEN OWNER.NAME LIKE 'EDB - HDA' THEN 'EDB - HDA' 
				WHEN OWNER.NAME LIKE 'HAB - BR - E' THEN 'HAB - E' 
				WHEN OWNER.NAME LIKE 'HAB - BR - DB' THEN 'HAB - DB'		
				WHEN SUBSTR(OWNER.NAME,0,INSTR(OWNER.NAME,' ')-1) = 'TI' THEN 'IT' 
				ELSE SUBSTR(OWNER.NAME,0,INSTR(OWNER.NAME,' ')-1) 
				END OWNER
		FROM 
			INV_INVESTMENTS INVI
			JOIN ODF_CA_INV OCINV ON INVI.ID = OCINV.ID
			LEFT JOIN CMN_LOOKUPS_V STATUS ON STATUS.LOOKUP_CODE = OCINV.hon_status AND STATUS.LANGUAGE_CODE = 'pt' AND STATUS.LOOKUP_TYPE = 'HON_STATUS_INVESTIMENTO'
			JOIN CMN_LOOKUPS_V STAGE_ATU ON INVI.STAGE_CODE = STAGE_ATU.LOOKUP_CODE AND   STAGE_ATU.LANGUAGE_CODE = 'pt' AND STAGE_ATU.LOOKUP_TYPE = 'INV_STAGE_TYPE' AND STAGE_ATU.PARENT_LOOKUP_CODE = 'hon_hsdm'
			JOIN CMN_LOOKUPS_V OWNER ON OWNER.LOOKUP_CODE = OCINV.hon_area AND OWNER.LANGUAGE_CODE = 'pt' AND OWNER.LOOKUP_TYPE = 'HON_LKP_AREA'
				LEFT JOIN (SELECT MAX(ID) MAX_ID, ODF_PARENT_ID INV_ID FROM odf_ca_cop_prj_statusrpt WHERE TRUNC(COP_REPORT_DATE,'MONTH') <= TRUNC(ADD_MONTHS($P{data_referencia},-1),'MONTH') AND COP_REPORT_STATUS = 'FINAL' AND HON_TIPO_REL_STATUS = 'mensal' GROUP BY ODF_PARENT_ID) MAX_REPORT ON MAX_REPORT.INV_ID = INVI.ID
				LEFT JOIN odf_ca_cop_prj_statusrpt STATUS_RPT ON MAX_REPORT.MAX_ID = STATUS_RPT.ID 
			LEFT JOIN PFM_INVESTMENTS PFMI ON PFMI.INVESTMENT_ID = INVI.ID
			LEFT JOIN PFM_PORTFOLIOS PFMP ON PFMI.PORTFOLIO_ID = PFMP.ID
			LEFT JOIN (SELECT MAX(ID) MAX_AUDIT, OBJECT_ID INV_ID from cmn_audits where ATTRIBUTE_CODE = 'stage_code' AND  LAST_UPDATED_DATE <= TRUNC(ADD_MONTHS($P{data_referencia},-1),'MONTH') GROUP BY OBJECT_ID) MAX_AUDIT ON MAX_AUDIT.INV_ID = INVI.ID
			LEFT JOIN CMN_AUDITS AUD ON AUD.ID = MAX_AUDIT.MAX_AUDIT
			LEFT JOIN CMN_LOOKUPS_V STAGE ON AUD.RAW_VALUE_AFTER = STAGE.LOOKUP_CODE AND   STAGE.LANGUAGE_CODE = 'pt' AND STAGE.LOOKUP_TYPE = 'INV_STAGE_TYPE' AND STAGE.PARENT_LOOKUP_CODE = 'hon_hsdm' 
			LEFT JOIN CMN_LOOKUPS_V STAGE_RPT ON STAGE_RPT.LOOKUP_CODE = STATUS_RPT.hon_fase_atual AND STAGE_RPT.LANGUAGE_CODE = 'pt' AND STAGE_RPT.LOOKUP_TYPE = 'HON_LKP_FASE_PROJETO'
			JOIN ODF_CA_HON_REQUISITOS OCREQ ON INVI.ID = OCREQ.ODF_PARENT_ID
		WHERE 
			PFMP.ID = $P{portfolio} 
			AND INVI.ODF_OBJECT_CODE = 'project'
			AND OCREQ.hon_fase_inclusao IN ('hon_lkp_j1','hon_lkp_j2','hon_lkp_j3','hon_lkp_j4','hon_lkp_j5')
			AND $X{IN,STAGE_RPT.NAME,fase}
		
		UNION ALL

		SELECT 
			0 REQUISITO,
			1 CHANGE,
				CASE 
				WHEN OWNER.NAME LIKE 'S - CS' THEN 'CS' 
				WHEN OWNER.NAME LIKE 'S - PARTS' THEN 'SP' 
				WHEN OWNER.NAME LIKE 'EDB - HDA' THEN 'EDB - HDA' 
				WHEN OWNER.NAME LIKE 'HAB - BR - E' THEN 'HAB - E' 
				WHEN OWNER.NAME LIKE 'HAB - BR - DB' THEN 'HAB - DB'		
				WHEN SUBSTR(OWNER.NAME,0,INSTR(OWNER.NAME,' ')-1) = 'TI' THEN 'IT' 
				ELSE SUBSTR(OWNER.NAME,0,INSTR(OWNER.NAME,' ')-1) 
				END OWNER
		FROM 
			INV_INVESTMENTS INVI
			JOIN ODF_CA_INV OCINV ON INVI.ID = OCINV.ID
			LEFT JOIN CMN_LOOKUPS_V STATUS ON STATUS.LOOKUP_CODE = OCINV.hon_status AND STATUS.LANGUAGE_CODE = 'pt' AND STATUS.LOOKUP_TYPE = 'HON_STATUS_INVESTIMENTO'
			JOIN CMN_LOOKUPS_V STAGE_ATU ON INVI.STAGE_CODE = STAGE_ATU.LOOKUP_CODE AND   STAGE_ATU.LANGUAGE_CODE = 'pt' AND STAGE_ATU.LOOKUP_TYPE = 'INV_STAGE_TYPE' AND STAGE_ATU.PARENT_LOOKUP_CODE = 'hon_hsdm'
			JOIN CMN_LOOKUPS_V OWNER ON OWNER.LOOKUP_CODE = OCINV.hon_area AND OWNER.LANGUAGE_CODE = 'pt' AND OWNER.LOOKUP_TYPE = 'HON_LKP_AREA'
				LEFT JOIN (SELECT MAX(ID) MAX_ID, ODF_PARENT_ID INV_ID FROM odf_ca_cop_prj_statusrpt WHERE TRUNC(COP_REPORT_DATE,'MONTH') <= TRUNC(ADD_MONTHS($P{data_referencia},-1),'MONTH') AND COP_REPORT_STATUS = 'FINAL' AND HON_TIPO_REL_STATUS = 'mensal' GROUP BY ODF_PARENT_ID) MAX_REPORT ON MAX_REPORT.INV_ID = INVI.ID
				LEFT JOIN odf_ca_cop_prj_statusrpt STATUS_RPT ON MAX_REPORT.MAX_ID = STATUS_RPT.ID 
			LEFT JOIN PFM_INVESTMENTS PFMI ON PFMI.INVESTMENT_ID = INVI.ID
			LEFT JOIN PFM_PORTFOLIOS PFMP ON PFMI.PORTFOLIO_ID = PFMP.ID
			LEFT JOIN (SELECT MAX(ID) MAX_AUDIT, OBJECT_ID INV_ID from cmn_audits where ATTRIBUTE_CODE = 'stage_code' AND  LAST_UPDATED_DATE <= TRUNC(ADD_MONTHS($P{data_referencia},-1),'MONTH') GROUP BY OBJECT_ID) MAX_AUDIT ON MAX_AUDIT.INV_ID = INVI.ID
			LEFT JOIN CMN_AUDITS AUD ON AUD.ID = MAX_AUDIT.MAX_AUDIT
			LEFT JOIN CMN_LOOKUPS_V STAGE ON AUD.RAW_VALUE_AFTER = STAGE.LOOKUP_CODE AND   STAGE.LANGUAGE_CODE = 'pt' AND STAGE.LOOKUP_TYPE = 'INV_STAGE_TYPE' AND STAGE.PARENT_LOOKUP_CODE = 'hon_hsdm' 
			LEFT JOIN CMN_LOOKUPS_V STAGE_RPT ON STAGE_RPT.LOOKUP_CODE = STATUS_RPT.hon_fase_atual AND STAGE_RPT.LANGUAGE_CODE = 'pt' AND STAGE_RPT.LOOKUP_TYPE = 'HON_LKP_FASE_PROJETO'
			JOIN ODF_CA_HON_REQUISITOS OCREQ ON INVI.ID = OCREQ.ODF_PARENT_ID
		WHERE 
			PFMP.ID = $P{portfolio} 
			AND INVI.ODF_OBJECT_CODE = 'project'
			AND OCREQ.hon_fase_cancel IN ('hon_lkp_j1','hon_lkp_j2','hon_lkp_j3','hon_lkp_j4','hon_lkp_j5')
			AND $X{IN,STAGE_RPT.NAME,fase}
		
		UNION ALL

		SELECT 
			0 REQUISITO,
			1 CHANGE,
				CASE 
				WHEN OWNER.NAME LIKE 'S - CS' THEN 'CS' 
				WHEN OWNER.NAME LIKE 'S - PARTS' THEN 'SP' 
				WHEN OWNER.NAME LIKE 'EDB - HDA' THEN 'EDB - HDA' 
				WHEN OWNER.NAME LIKE 'HAB - BR - E' THEN 'HAB - E' 
				WHEN OWNER.NAME LIKE 'HAB - BR - DB' THEN 'HAB - DB'		
				WHEN SUBSTR(OWNER.NAME,0,INSTR(OWNER.NAME,' ')-1) = 'TI' THEN 'IT' 
				ELSE SUBSTR(OWNER.NAME,0,INSTR(OWNER.NAME,' ')-1) 
				END OWNER
		FROM 
			INV_INVESTMENTS INVI
			JOIN ODF_CA_INV OCINV ON INVI.ID = OCINV.ID
			LEFT JOIN CMN_LOOKUPS_V STATUS ON STATUS.LOOKUP_CODE = OCINV.hon_status AND STATUS.LANGUAGE_CODE = 'pt' AND STATUS.LOOKUP_TYPE = 'HON_STATUS_INVESTIMENTO'
			JOIN CMN_LOOKUPS_V STAGE_ATU ON INVI.STAGE_CODE = STAGE_ATU.LOOKUP_CODE AND   STAGE_ATU.LANGUAGE_CODE = 'pt' AND STAGE_ATU.LOOKUP_TYPE = 'INV_STAGE_TYPE' AND STAGE_ATU.PARENT_LOOKUP_CODE = 'hon_hsdm'
			JOIN CMN_LOOKUPS_V OWNER ON OWNER.LOOKUP_CODE = OCINV.hon_area AND OWNER.LANGUAGE_CODE = 'pt' AND OWNER.LOOKUP_TYPE = 'HON_LKP_AREA'
				LEFT JOIN (SELECT MAX(ID) MAX_ID, ODF_PARENT_ID INV_ID FROM odf_ca_cop_prj_statusrpt WHERE TRUNC(COP_REPORT_DATE,'MONTH') <= TRUNC(ADD_MONTHS($P{data_referencia},-1),'MONTH') AND COP_REPORT_STATUS = 'FINAL' AND HON_TIPO_REL_STATUS = 'mensal' GROUP BY ODF_PARENT_ID) MAX_REPORT ON MAX_REPORT.INV_ID = INVI.ID
				LEFT JOIN odf_ca_cop_prj_statusrpt STATUS_RPT ON MAX_REPORT.MAX_ID = STATUS_RPT.ID 
			LEFT JOIN PFM_INVESTMENTS PFMI ON PFMI.INVESTMENT_ID = INVI.ID
			LEFT JOIN PFM_PORTFOLIOS PFMP ON PFMI.PORTFOLIO_ID = PFMP.ID
			LEFT JOIN (SELECT MAX(ID) MAX_AUDIT, OBJECT_ID INV_ID from cmn_audits where ATTRIBUTE_CODE = 'stage_code' AND  LAST_UPDATED_DATE <= TRUNC(ADD_MONTHS($P{data_referencia},-1),'MONTH') GROUP BY OBJECT_ID) MAX_AUDIT ON MAX_AUDIT.INV_ID = INVI.ID
			LEFT JOIN CMN_AUDITS AUD ON AUD.ID = MAX_AUDIT.MAX_AUDIT
			LEFT JOIN CMN_LOOKUPS_V STAGE ON AUD.RAW_VALUE_AFTER = STAGE.LOOKUP_CODE AND   STAGE.LANGUAGE_CODE = 'pt' AND STAGE.LOOKUP_TYPE = 'INV_STAGE_TYPE' AND STAGE.PARENT_LOOKUP_CODE = 'hon_hsdm' 
			LEFT JOIN CMN_LOOKUPS_V STAGE_RPT ON STAGE_RPT.LOOKUP_CODE = STATUS_RPT.hon_fase_atual AND STAGE_RPT.LANGUAGE_CODE = 'pt' AND STAGE_RPT.LOOKUP_TYPE = 'HON_LKP_FASE_PROJETO'
			JOIN ODF_CA_HON_REQUISITOS OCREQ ON INVI.ID = OCREQ.ODF_PARENT_ID
		WHERE 
			PFMP.ID = $P{portfolio} 
			AND INVI.ODF_OBJECT_CODE = 'project'
			AND OCREQ.hon_fase_alteracao IN ('hon_lkp_j1','hon_lkp_j2','hon_lkp_j3','hon_lkp_j4','hon_lkp_j5')
			AND $X{IN,STAGE_RPT.NAME,fase}
	)
	WHERE 
		$X{IN,OWNER,owner}

	UNION

	SELECT 
		0 TOTAL,
		0 QTD_KPI,
		0 PCT_KPI,
		HON_META TARGET_PCT,
		HON_TIPO_META,
		7 ORDEM
	FROM
		ODF_CA_HON_META META
	WHERE 
		META.hon_tipo_meta = 'scope_changes_req'
		AND META.HON_DATA_INI = (SELECT MAX(HON_DATA_INI) FROM ODF_CA_HON_META WHERE HON_TIPO_META = 'scope_changes_req' AND TRUNC(HON_DATA_INI,'MONTH') <= TRUNC($P{data_referencia} ,'MONTH')-1 )

) KPI
JOIN CMN_LOOKUPS_V TIPO ON TIPO.LOOKUP_TYPE = 'HON_LKP_TIPOS_META' AND TIPO.LOOKUP_CODE = KPI.TIPO AND TIPO.LANGUAGE_CODE = 'pt'

GROUP BY
TIPO.NAME]]>
		</queryString>
		<field name="META" class="java.lang.String"/>
		<field name="TOTAL" class="java.math.BigDecimal"/>
		<field name="QTD_KPI" class="java.math.BigDecimal"/>
		<field name="PCT_KPI" class="java.math.BigDecimal"/>
		<field name="TARGET" class="java.math.BigDecimal"/>
		<field name="EVAL" class="java.math.BigDecimal"/>
		<field name="EVAL_ID" class="java.math.BigDecimal"/>
	</subDataset>
	<parameter name="data_referencia" class="java.util.Date"/>
	<parameter name="owner" class="java.util.Collection"/>
	<parameter name="portfolio" class="java.lang.String"/>
	<parameter name="fase" class="java.util.Collection"/>
	<queryString>
		<![CDATA[SELECT NULL FROM DUAL]]>
	</queryString>
	<field name="NULL" class="java.lang.String"/>
	<pageHeader>
		<band height="60" splitType="Stretch">
			<textField>
				<reportElement x="0" y="0" width="1210" height="60" uuid="9bd2a36f-33cb-4197-8a4e-e032bc185997"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="26"/>
				</textElement>
				<textFieldExpression><![CDATA["Projects Status "+ (MONTH(EDATE($P{data_referencia},-1)).intValue()<=3?YEAR(EDATE($P{data_referencia},-1))-1924:YEAR(EDATE($P{data_referencia},-1))-1923) +"ki - " + (MONTH(EDATE($P{data_referencia},-1)).intValue()==1?"JAN":MONTH(EDATE($P{data_referencia},-1)).intValue()==2?"FEB":MONTH(EDATE($P{data_referencia},-1)).intValue()==3?"MAR":MONTH(EDATE($P{data_referencia},-1)).intValue()==4?"APR":MONTH(EDATE($P{data_referencia},-1)).intValue()==5?"MAY":MONTH(EDATE($P{data_referencia},-1)).intValue()==6?"JUN":MONTH(EDATE($P{data_referencia},-1)).intValue()==7?"JUL":MONTH(EDATE($P{data_referencia},-1)).intValue()==8?"AUG":MONTH(EDATE($P{data_referencia},-1)).intValue()==9?"SEP":MONTH(EDATE($P{data_referencia},-1)).intValue()==10?"OCT":MONTH(EDATE($P{data_referencia},-1)).intValue()==11?"NOV":"DEC") + "/" + YEAR(EDATE($P{data_referencia},-1)).toString()]]></textFieldExpression>
			</textField>
		</band>
	</pageHeader>
	<detail>
		<band height="620" splitType="Stretch">
			<componentElement>
				<reportElement x="0" y="0" width="680" height="370" uuid="6c7ab1e8-0808-431a-aeef-c1186ea0a208">
					<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
				</reportElement>
				<hc:chart xmlns:hc="http://jaspersoft.com/highcharts" xsi:schemaLocation="http://jaspersoft.com/highcharts http://jaspersoft.com/schema/highcharts.xsd" type="Pie">
					<hc:chartSetting name="default">
						<hc:chartProperty name="chart.alignTicks">
							<hc:propertyExpression><![CDATA[Boolean.TRUE]]></hc:propertyExpression>
						</hc:chartProperty>
						<hc:chartProperty name="chart.zoomType">
							<hc:propertyExpression><![CDATA["xy"]]></hc:propertyExpression>
						</hc:chartProperty>
						<hc:chartProperty name="colors">
							<hc:propertyExpression><![CDATA[java.util.Arrays.asList("#f45b5b","#91e8e1","#e4d354","#90ed7d","#7cb5ec","#f7a35c","#8085e9","#f15c80","#2b908f","#FF8080")]]></hc:propertyExpression>
						</hc:chartProperty>
						<hc:chartProperty name="credits.enabled">
							<hc:propertyExpression><![CDATA[false]]></hc:propertyExpression>
						</hc:chartProperty>
						<hc:chartProperty name="credits.href">
							<hc:propertyExpression><![CDATA[""]]></hc:propertyExpression>
						</hc:chartProperty>
						<hc:chartProperty name="credits.text">
							<hc:propertyExpression><![CDATA[""]]></hc:propertyExpression>
						</hc:chartProperty>
						<hc:chartProperty name="plotOptions.pie.dataLabels.enabled" value="TRUE"/>
						<hc:chartProperty name="plotOptions.pie.dataLabels.format">
							<hc:propertyExpression><![CDATA["{point.y}; {point.percentage:.0f} %"]]></hc:propertyExpression>
						</hc:chartProperty>
						<hc:chartProperty name="plotOptions.pie.showInLegend" value="true"/>
						<hc:chartProperty name="plotOptions.series.showInLegend">
							<hc:propertyExpression><![CDATA[Boolean.TRUE]]></hc:propertyExpression>
						</hc:chartProperty>
						<hc:chartProperty name="title.style.fontSize">
							<hc:propertyExpression><![CDATA["20"]]></hc:propertyExpression>
						</hc:chartProperty>
						<hc:chartProperty name="title.text">
							<hc:propertyExpression><![CDATA["Geral"]]></hc:propertyExpression>
						</hc:chartProperty>
						<hc:chartProperty name="tooltip.enabled">
							<hc:propertyExpression><![CDATA[Boolean.FALSE]]></hc:propertyExpression>
						</hc:chartProperty>
						<hc:chartProperty name="yAxis.title.text">
							<hc:propertyExpression><![CDATA[""]]></hc:propertyExpression>
						</hc:chartProperty>
					</hc:chartSetting>
					<multiAxisData>
						<multiAxisDataset>
							<dataset>
								<datasetRun subDataset="Dados" uuid="14d4c05d-a002-4e7c-99d9-8d7c9b04cf63">
									<datasetParameter name="data_referencia">
										<datasetParameterExpression><![CDATA[$P{data_referencia}]]></datasetParameterExpression>
									</datasetParameter>
									<datasetParameter name="owner">
										<datasetParameterExpression><![CDATA[$P{owner}]]></datasetParameterExpression>
									</datasetParameter>
									<datasetParameter name="portfolio">
										<datasetParameterExpression><![CDATA[$P{portfolio}]]></datasetParameterExpression>
									</datasetParameter>
									<datasetParameter name="fase">
										<datasetParameterExpression><![CDATA[$P{fase}]]></datasetParameterExpression>
									</datasetParameter>
									<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
								</datasetRun>
							</dataset>
						</multiAxisDataset>
						<dataAxis axis="Rows">
							<axisLevel name="Status">
								<labelExpression><![CDATA[]]></labelExpression>
								<axisLevelBucket order="None" class="java.lang.String">
									<bucketExpression><![CDATA[$F{STATUS_FINAL}]]></bucketExpression>
									<bucketProperty name="color"><![CDATA[$F{STATUS_FINAL}.toString().equals("No Prazo") ? "#89a54e"
: $F{STATUS_FINAL}.toString().equals("Demanda No Prazo") ? "#c8d7a8"
: $F{STATUS_FINAL}.toString().equals("On hold") ? "#404040"
: $F{STATUS_FINAL}.toString().equals("Demanda On hold") ? "#d9d9d9"
: $F{STATUS_FINAL}.toString().equals("Atrasado") ? "#ff5050"
: $F{STATUS_FINAL}.toString().equals("Demanda Atrasada") ? "#ff9999"
: $F{STATUS_FINAL}.toString().equals("Cancelado") ? "#9933ff"
: $F{STATUS_FINAL}.toString().equals("Demanda Cancelada") ? "#cc99ff"
: $F{STATUS_FINAL}.toString().equals("Extra") ? "#ffff66"
: $F{STATUS_FINAL}.toString().equals("Sem Status") ? "#91E8E1"
: $F{STATUS_FINAL}.toString().equals("Concluído") ? "#7CB5EC"
: "#b9cde5"]]></bucketProperty>
								</axisLevelBucket>
							</axisLevel>
						</dataAxis>
						<dataAxis axis="Columns"/>
						<multiAxisMeasure name="QTD" class="java.lang.Integer" calculation="Nothing">
							<labelExpression><![CDATA["Geral"]]></labelExpression>
							<valueExpression><![CDATA[$F{QTD}]]></valueExpression>
						</multiAxisMeasure>
					</multiAxisData>
					<hc:series name="QTD">
						<hc:contributor name="SeriesItemProperty">
							<hc:contributorProperty name="color" valueType="Bucket" value="Status.color"/>
						</hc:contributor>
					</hc:series>
				</hc:chart>
			</componentElement>
			<componentElement>
				<reportElement x="682" y="0" width="528" height="370" uuid="fac40ccb-f8d3-42a1-baee-13132ec7d992">
					<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.x" value="pixel"/>
				</reportElement>
				<hc:chart xmlns:hc="http://jaspersoft.com/highcharts" xsi:schemaLocation="http://jaspersoft.com/highcharts http://jaspersoft.com/schema/highcharts.xsd" type="StackedColumn">
					<hc:chartSetting name="default">
						<hc:chartProperty name="chart.zoomType">
							<hc:propertyExpression><![CDATA["xy"]]></hc:propertyExpression>
						</hc:chartProperty>
						<hc:chartProperty name="colors">
							<hc:propertyExpression><![CDATA[java.util.Arrays.asList("#f45b5b","#91e8e1","#e4d354","#90ed7d","#7cb5ec","#f7a35c","#8085e9","#f15c80","#2b908f","#FF8080")]]></hc:propertyExpression>
						</hc:chartProperty>
						<hc:chartProperty name="credits.enabled">
							<hc:propertyExpression><![CDATA[false]]></hc:propertyExpression>
						</hc:chartProperty>
						<hc:chartProperty name="credits.href">
							<hc:propertyExpression><![CDATA[""]]></hc:propertyExpression>
						</hc:chartProperty>
						<hc:chartProperty name="credits.text">
							<hc:propertyExpression><![CDATA[""]]></hc:propertyExpression>
						</hc:chartProperty>
						<hc:chartProperty name="plotOptions.series.dataLabels.enabled" value="TRUE"/>
						<hc:chartProperty name="title.style.fontSize">
							<hc:propertyExpression><![CDATA["20"]]></hc:propertyExpression>
						</hc:chartProperty>
						<hc:chartProperty name="title.text">
							<hc:propertyExpression><![CDATA["Status por Fase do Projeto"]]></hc:propertyExpression>
						</hc:chartProperty>
						<hc:chartProperty name="xAxis.labels.rotation">
							<hc:propertyExpression><![CDATA[new Integer(0)]]></hc:propertyExpression>
						</hc:chartProperty>
						<hc:chartProperty name="yAxis.title.text">
							<hc:propertyExpression><![CDATA[""]]></hc:propertyExpression>
						</hc:chartProperty>
						<hc:chartProperty name="legend.align" value="right"/>
						<hc:chartProperty name="legend.enabled">
							<hc:propertyExpression><![CDATA[Boolean.FALSE]]></hc:propertyExpression>
						</hc:chartProperty>
						<hc:chartProperty name="legend.layout" value="vertical"/>
						<hc:chartProperty name="legend.verticalAlign" value="middle"/>
						<hc:chartProperty name="yAxis.gridLineColor" value="white"/>
						<hc:chartProperty name="yAxis.labels.enabled">
							<hc:propertyExpression><![CDATA[FALSE( )]]></hc:propertyExpression>
						</hc:chartProperty>
					</hc:chartSetting>
					<multiAxisData>
						<multiAxisDataset>
							<dataset>
								<datasetRun subDataset="fases" uuid="d153fb77-d34c-47e0-81f0-e74d66ecad70">
									<datasetParameter name="data_referencia">
										<datasetParameterExpression><![CDATA[$P{data_referencia}]]></datasetParameterExpression>
									</datasetParameter>
									<datasetParameter name="owner">
										<datasetParameterExpression><![CDATA[$P{owner}]]></datasetParameterExpression>
									</datasetParameter>
									<datasetParameter name="portfolio">
										<datasetParameterExpression><![CDATA[$P{portfolio}]]></datasetParameterExpression>
									</datasetParameter>
									<datasetParameter name="fase">
										<datasetParameterExpression><![CDATA[$P{fase}]]></datasetParameterExpression>
									</datasetParameter>
									<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
								</datasetRun>
							</dataset>
						</multiAxisDataset>
						<dataAxis axis="Rows">
							<axisLevel name="Fase">
								<labelExpression><![CDATA[]]></labelExpression>
								<axisLevelBucket order="None" class="java.lang.String">
									<bucketExpression><![CDATA[$F{FASE}]]></bucketExpression>
								</axisLevelBucket>
							</axisLevel>
						</dataAxis>
						<dataAxis axis="Columns">
							<axisLevel name="Status">
								<labelExpression><![CDATA[]]></labelExpression>
								<axisLevelBucket order="None" class="java.lang.String">
									<bucketExpression><![CDATA[$F{STATUS}]]></bucketExpression>
									<bucketProperty name="color"><![CDATA[$F{STATUS}.toString().equals("No Prazo") ? "#89a54e"
: $F{STATUS}.toString().equals("Demanda No Prazo") ? "#c8d7a8"
: $F{STATUS}.toString().equals("On hold") ? "#404040"
: $F{STATUS}.toString().equals("Demanda On hold") ? "#d9d9d9"
: $F{STATUS}.toString().equals("Atrasado") ? "#ff5050"
: $F{STATUS}.toString().equals("Demanda Atrasada") ? "#ff9999"
: $F{STATUS}.toString().equals("Cancelado") ? "#9933ff"
: $F{STATUS}.toString().equals("Demanda Cancelada") ? "#cc99ff"
: $F{STATUS}.toString().equals("Extra") ? "#ffff66"
: $F{STATUS}.toString().equals("Sem Status") ? "#91E8E1"
: $F{STATUS}.toString().equals("Concluído") ? "#7CB5EC"
: "#b9cde5"]]></bucketProperty>
								</axisLevelBucket>
							</axisLevel>
						</dataAxis>
						<multiAxisMeasure name="Qtd" class="java.lang.Integer" calculation="Count">
							<labelExpression><![CDATA[""]]></labelExpression>
							<valueExpression><![CDATA[$F{INV_ID}]]></valueExpression>
						</multiAxisMeasure>
					</multiAxisData>
					<hc:series name="Qtd">
						<hc:contributor name="SeriesItemProperty">
							<hc:contributorProperty name="color" valueType="Bucket" value="Status.color"/>
						</hc:contributor>
					</hc:series>
				</hc:chart>
			</componentElement>
			<componentElement>
				<reportElement x="0" y="370" width="680" height="250" uuid="1b7f2372-0424-44c4-9c49-163a5c77f0bb">
					<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
				</reportElement>
				<hc:chart xmlns:hc="http://jaspersoft.com/highcharts" xsi:schemaLocation="http://jaspersoft.com/highcharts http://jaspersoft.com/schema/highcharts.xsd" type="StackedColumn">
					<hc:chartSetting name="default">
						<hc:chartProperty name="chart.zoomType">
							<hc:propertyExpression><![CDATA["xy"]]></hc:propertyExpression>
						</hc:chartProperty>
						<hc:chartProperty name="colors">
							<hc:propertyExpression><![CDATA[java.util.Arrays.asList("#f45b5b","#91e8e1","#e4d354","#90ed7d","#7cb5ec","#f7a35c","#8085e9","#f15c80","#2b908f","#FF8080")]]></hc:propertyExpression>
						</hc:chartProperty>
						<hc:chartProperty name="credits.enabled">
							<hc:propertyExpression><![CDATA[false]]></hc:propertyExpression>
						</hc:chartProperty>
						<hc:chartProperty name="credits.href">
							<hc:propertyExpression><![CDATA[""]]></hc:propertyExpression>
						</hc:chartProperty>
						<hc:chartProperty name="credits.text">
							<hc:propertyExpression><![CDATA[""]]></hc:propertyExpression>
						</hc:chartProperty>
						<hc:chartProperty name="legend.enabled">
							<hc:propertyExpression><![CDATA[Boolean.FALSE]]></hc:propertyExpression>
						</hc:chartProperty>
						<hc:chartProperty name="plotOptions.series.dataLabels.enabled" value="TRUE"/>
						<hc:chartProperty name="title.style.fontSize">
							<hc:propertyExpression><![CDATA["20"]]></hc:propertyExpression>
						</hc:chartProperty>
						<hc:chartProperty name="title.text">
							<hc:propertyExpression><![CDATA["Status por Negócio (Owner)"]]></hc:propertyExpression>
						</hc:chartProperty>
						<hc:chartProperty name="xAxis.labels.rotation">
							<hc:propertyExpression><![CDATA[new Integer(0)]]></hc:propertyExpression>
						</hc:chartProperty>
						<hc:chartProperty name="yAxis.title.text">
							<hc:propertyExpression><![CDATA[""]]></hc:propertyExpression>
						</hc:chartProperty>
						<hc:chartProperty name="yAxis.gridLineColor" value="white"/>
						<hc:chartProperty name="yAxis.labels.enabled">
							<hc:propertyExpression><![CDATA[FALSE( )]]></hc:propertyExpression>
						</hc:chartProperty>
						<hc:chartProperty name="xAxis.gridLineColor" value="white"/>
					</hc:chartSetting>
					<multiAxisData>
						<multiAxisDataset>
							<dataset>
								<datasetRun subDataset="owner" uuid="abcc0b56-497e-473e-bf01-790470fb5eea">
									<datasetParameter name="data_referencia">
										<datasetParameterExpression><![CDATA[$P{data_referencia}]]></datasetParameterExpression>
									</datasetParameter>
									<datasetParameter name="owner">
										<datasetParameterExpression><![CDATA[$P{owner}]]></datasetParameterExpression>
									</datasetParameter>
									<datasetParameter name="portfolio">
										<datasetParameterExpression><![CDATA[$P{portfolio}]]></datasetParameterExpression>
									</datasetParameter>
									<datasetParameter name="fase">
										<datasetParameterExpression><![CDATA[$P{fase}]]></datasetParameterExpression>
									</datasetParameter>
									<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
								</datasetRun>
							</dataset>
						</multiAxisDataset>
						<dataAxis axis="Rows">
							<axisLevel name="OWNER">
								<labelExpression><![CDATA[]]></labelExpression>
								<axisLevelBucket order="None" class="java.lang.String">
									<bucketExpression><![CDATA[$F{OWNER}]]></bucketExpression>
								</axisLevelBucket>
							</axisLevel>
							<axisLevel name="FASE">
								<labelExpression><![CDATA[]]></labelExpression>
								<axisLevelBucket order="None" class="java.lang.String">
									<bucketExpression><![CDATA[$F{FASE}]]></bucketExpression>
								</axisLevelBucket>
							</axisLevel>
						</dataAxis>
						<dataAxis axis="Columns">
							<axisLevel name="Status">
								<labelExpression><![CDATA[]]></labelExpression>
								<axisLevelBucket order="None" class="java.lang.String">
									<bucketExpression><![CDATA[$F{STATUS}]]></bucketExpression>
									<bucketProperty name="color"><![CDATA[$F{STATUS}.toString().equals("No Prazo") ? "#89a54e"
: $F{STATUS}.toString().equals("Demanda No Prazo") ? "#c8d7a8"
: $F{STATUS}.toString().equals("On hold") ? "#404040"
: $F{STATUS}.toString().equals("Demanda On hold") ? "#d9d9d9"
: $F{STATUS}.toString().equals("Atrasado") ? "#ff5050"
: $F{STATUS}.toString().equals("Demanda Atrasada") ? "#ff9999"
: $F{STATUS}.toString().equals("Cancelado") ? "#9933ff"
: $F{STATUS}.toString().equals("Demanda Cancelada") ? "#cc99ff"
: $F{STATUS}.toString().equals("Extra") ? "#ffff66"
: $F{STATUS}.toString().equals("Sem Status") ? "#91E8E1"
: $F{STATUS}.toString().equals("Concluído") ? "#7CB5EC"
: "#b9cde5"]]></bucketProperty>
								</axisLevelBucket>
							</axisLevel>
						</dataAxis>
						<multiAxisMeasure name="Measure1" class="java.lang.Integer" calculation="Count">
							<labelExpression><![CDATA[""]]></labelExpression>
							<valueExpression><![CDATA[$F{INV_ID}]]></valueExpression>
						</multiAxisMeasure>
					</multiAxisData>
					<hc:series name="Measure1">
						<hc:contributor name="SeriesItemProperty">
							<hc:contributorProperty name="color" valueType="Bucket" value="Status.color"/>
						</hc:contributor>
					</hc:series>
				</hc:chart>
			</componentElement>
			<componentElement>
				<reportElement x="682" y="370" width="528" height="70" uuid="1f3cf9ba-687e-432a-b208-7eebdaec8b63">
					<property name="com.jaspersoft.studio.layout" value="com.jaspersoft.studio.editor.layout.VerticalRowLayout"/>
					<property name="com.jaspersoft.studio.table.style.table_header" value="Table 1_TH"/>
					<property name="com.jaspersoft.studio.table.style.column_header" value="Table 1_CH"/>
					<property name="com.jaspersoft.studio.table.style.detail" value="Table 1_TD"/>
				</reportElement>
				<jr:table xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd">
					<datasetRun subDataset="Status_kpi" uuid="32356380-60ad-466a-8024-a06c5c7c57c1">
						<datasetParameter name="data_referencia">
							<datasetParameterExpression><![CDATA[$P{data_referencia}]]></datasetParameterExpression>
						</datasetParameter>
						<datasetParameter name="fase">
							<datasetParameterExpression><![CDATA[$P{fase}]]></datasetParameterExpression>
						</datasetParameter>
						<datasetParameter name="owner">
							<datasetParameterExpression><![CDATA[$P{owner}]]></datasetParameterExpression>
						</datasetParameter>
						<datasetParameter name="portfolio">
							<datasetParameterExpression><![CDATA[$P{portfolio}]]></datasetParameterExpression>
						</datasetParameter>
						<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
					</datasetRun>
					<jr:column width="240" uuid="70c8888b-6626-41f8-ba84-fe6103ffca44">
						<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
						<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
						<jr:columnHeader style="Table 1_CH" height="30">
							<property name="com.jaspersoft.studio.unit.height" value="px"/>
							<property name="com.jaspersoft.studio.unit.width" value="px"/>
							<staticText>
								<reportElement x="0" y="0" width="240" height="30" uuid="4c3f3983-af43-46e5-b3b4-0c8cc4549c14"/>
								<textElement textAlignment="Center" verticalAlignment="Middle"/>
								<text><![CDATA[Metric]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="Table 1_TD" height="20">
							<textField>
								<reportElement x="0" y="0" width="240" height="20" uuid="b92f4ee1-e708-4189-8d0c-420b6393a30c"/>
								<textElement textAlignment="Center" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{META}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="70" uuid="859069c0-5488-42c3-ab39-e38755055eec">
						<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
						<jr:columnHeader style="Table 1_CH" height="30">
							<property name="com.jaspersoft.studio.unit.width" value="px"/>
							<staticText>
								<reportElement x="0" y="0" width="70" height="30" uuid="a1db4f1e-5e01-4b6b-98ac-06573c3f304b"/>
								<textElement textAlignment="Center" verticalAlignment="Middle"/>
								<text><![CDATA[Qty Projects Total]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="Table 1_TD" height="20">
							<textField>
								<reportElement x="0" y="0" width="70" height="20" uuid="338a59ef-a610-4346-908b-70bbbba37f0f"/>
								<textElement textAlignment="Center" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{TOTAL}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="110" uuid="e5d6e938-773c-4902-930d-a13fd54a34c1">
						<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
						<jr:columnHeader style="Table 1_CH" height="30">
							<property name="com.jaspersoft.studio.unit.width" value="px"/>
							<staticText>
								<reportElement x="0" y="0" width="110" height="30" uuid="39bdcd26-5331-4fe2-9100-4b76bedfb830"/>
								<textElement textAlignment="Center" verticalAlignment="Middle"/>
								<text><![CDATA[Qty Projects
on time/on budget]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="Table 1_TD" height="20">
							<textField>
								<reportElement x="0" y="0" width="110" height="20" uuid="769cf57b-ec97-4a88-9b22-a498836998fc"/>
								<textElement textAlignment="Center" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{QTD_KPI}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="40" uuid="12c4aeab-8f7c-4285-bcbf-d5b7ffb108db">
						<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
						<jr:columnHeader style="Table 1_CH" height="30">
							<property name="com.jaspersoft.studio.unit.width" value="px"/>
							<staticText>
								<reportElement x="0" y="0" width="40" height="30" uuid="719774ee-cb96-4b53-a965-f2d5765ad47b"/>
								<textElement textAlignment="Center" verticalAlignment="Middle"/>
								<text><![CDATA[Target]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="Table 1_TD" height="20">
							<textField pattern="###0.##%">
								<reportElement x="0" y="0" width="40" height="20" uuid="03d4b8e4-3f22-41a0-bc45-af4cecb46dd6"/>
								<textElement textAlignment="Center" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{TARGET}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="40" uuid="750cbf0c-906e-4452-bc8e-40a2e850ecd4">
						<jr:columnHeader style="Table 1_CH" height="30">
							<property name="com.jaspersoft.studio.unit.width" value="px"/>
							<staticText>
								<reportElement x="0" y="0" width="40" height="30" uuid="8794c489-7a3b-4480-a525-cba18daee999"/>
								<textElement textAlignment="Center" verticalAlignment="Middle"/>
								<text><![CDATA[Real]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="Table 1_TD" height="20">
							<textField pattern="###0.##%">
								<reportElement x="0" y="0" width="40" height="20" uuid="b96c92ca-3fb0-4d46-a02c-906d5008c856"/>
								<textElement textAlignment="Center" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{PCT_KPI}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="30" uuid="531bafd3-c33b-495b-a7b1-cc12f16267fe">
						<jr:columnHeader style="Table 1_CH" height="30">
							<staticText>
								<reportElement x="0" y="0" width="30" height="30" uuid="f876339a-b89d-40db-ac0d-44b55f6dadb6"/>
								<textElement textAlignment="Center" verticalAlignment="Middle"/>
								<text><![CDATA[Eval]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="Table 1_TD" height="20">
							<image scaleImage="RealSize" hAlign="Center" vAlign="Middle" onErrorType="Icon">
								<reportElement x="0" y="0" width="30" height="20" uuid="2be029aa-93fa-48e1-86ff-1b3c6c3711b9">
									<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
								</reportElement>
								<box>
									<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
									<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
									<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
									<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
								</box>
								<imageExpression><![CDATA[$F{EVAL_ID}.toString().equals("1") ? "Honda___Quadrado_Preenchido" 
: $F{EVAL_ID}.toString().equals("2") ? "hon_tri_preto"
: $F{EVAL_ID}.toString().equals("3") ? "hon_circ_preto"
: $F{EVAL_ID}.toString().equals("4") ? "hon_circ_dup"
: "hon_quad_preto"]]></imageExpression>
							</image>
						</jr:detailCell>
					</jr:column>
				</jr:table>
			</componentElement>
			<componentElement>
				<reportElement x="682" y="440" width="528" height="90" uuid="aae56bd1-4c18-4809-94c8-a6b431954a9d">
					<property name="com.jaspersoft.studio.layout" value="com.jaspersoft.studio.editor.layout.VerticalRowLayout"/>
					<property name="com.jaspersoft.studio.table.style.table_header" value="Table 2_TH"/>
					<property name="com.jaspersoft.studio.table.style.column_header" value="Table 2_CH"/>
					<property name="com.jaspersoft.studio.table.style.detail" value="Table 2_TD"/>
					<property name="net.sf.jasperreports.export.headertoolbar.table.name" value=""/>
					<property name="com.jaspersoft.studio.unit.y" value="pixel"/>
				</reportElement>
				<jr:table xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd">
					<datasetRun subDataset="tests_kpi" uuid="9f3793bc-9e48-4fc9-a513-373bc2ef4440">
						<datasetParameter name="data_referencia">
							<datasetParameterExpression><![CDATA[$P{data_referencia}]]></datasetParameterExpression>
						</datasetParameter>
						<datasetParameter name="fase">
							<datasetParameterExpression><![CDATA[$P{fase}]]></datasetParameterExpression>
						</datasetParameter>
						<datasetParameter name="owner">
							<datasetParameterExpression><![CDATA[$P{owner}]]></datasetParameterExpression>
						</datasetParameter>
						<datasetParameter name="portfolio">
							<datasetParameterExpression><![CDATA[$P{portfolio}]]></datasetParameterExpression>
						</datasetParameter>
						<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
					</datasetRun>
					<jr:column width="240" uuid="f81b4aee-5d1f-4246-a221-653076767126">
						<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
						<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
						<jr:columnHeader style="Table 2_CH" height="30">
							<property name="com.jaspersoft.studio.unit.height" value="px"/>
							<staticText>
								<reportElement x="0" y="0" width="240" height="30" uuid="ef95c989-8b4a-45ea-b4bc-a9d0823a68a5"/>
								<textElement textAlignment="Center" verticalAlignment="Middle"/>
								<text><![CDATA[]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="Table 2_TD" height="20">
							<property name="com.jaspersoft.studio.unit.width" value="px"/>
							<textField>
								<reportElement x="0" y="0" width="240" height="20" uuid="80ddbbf2-a376-458d-881c-c08033c36c58"/>
								<textElement textAlignment="Center" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{META}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="70" uuid="fe58b9a6-4508-4527-a2c4-67c9025512a5">
						<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
						<jr:columnHeader style="Table 2_CH" height="30">
							<staticText>
								<reportElement x="0" y="0" width="70" height="30" uuid="3c290460-01d0-4e42-981c-241f5151f1ae"/>
								<textElement textAlignment="Center" verticalAlignment="Middle"/>
								<text><![CDATA[Qty Scenarios]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="Table 2_TD" height="20">
							<property name="com.jaspersoft.studio.unit.width" value="px"/>
							<textField>
								<reportElement x="0" y="0" width="70" height="20" uuid="5792dfa9-a2a4-429a-9629-ead89a440034"/>
								<textElement textAlignment="Center" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{TOTAL}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="110" uuid="02510cd6-570c-4541-9f4c-584bf64bd117">
						<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
						<jr:columnHeader style="Table 2_CH" height="30">
							<staticText>
								<reportElement x="0" y="0" width="110" height="30" uuid="aef5878a-abc2-4ce2-82b6-77974f135a21"/>
								<textElement textAlignment="Center" verticalAlignment="Middle"/>
								<text><![CDATA[Qty Issues]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="Table 2_TD" height="20">
							<property name="com.jaspersoft.studio.unit.width" value="px"/>
							<textField>
								<reportElement x="0" y="0" width="110" height="20" uuid="5ec70066-abce-44a2-9d0b-f23dbfa2b1f7"/>
								<textElement textAlignment="Center" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{QTD_KPI}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="40" uuid="e71cc650-ac05-4456-b832-4d12d4e1ad8c">
						<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
						<jr:columnHeader style="Table 2_CH" height="30">
							<staticText>
								<reportElement x="0" y="0" width="40" height="30" uuid="a5a35767-5d90-4412-872a-36daecf69566"/>
								<textElement textAlignment="Center" verticalAlignment="Middle"/>
								<text><![CDATA[Target]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="Table 2_TD" height="20">
							<property name="com.jaspersoft.studio.unit.width" value="px"/>
							<textField pattern="###0.##%">
								<reportElement x="0" y="0" width="40" height="20" uuid="7833e537-24a0-44b3-9261-aaad8b8ed243"/>
								<textElement textAlignment="Center" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{TARGET}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="40" uuid="71b18b94-78d8-4233-b7db-1ac285400dc1">
						<jr:columnHeader style="Table 2_CH" height="30">
							<staticText>
								<reportElement x="0" y="0" width="40" height="30" uuid="d0c9cbba-f5c7-45a2-8153-2071b308597c"/>
								<textElement textAlignment="Center" verticalAlignment="Middle"/>
								<text><![CDATA[Real]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="Table 2_TD" height="20">
							<property name="com.jaspersoft.studio.unit.width" value="px"/>
							<textField pattern="###0.##%">
								<reportElement x="0" y="0" width="40" height="20" uuid="0c80413d-f70e-4b32-864e-381717e4032d"/>
								<textElement textAlignment="Center" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{PCT_KPI}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="30" uuid="42e1d3fb-e27e-4a8f-add1-c35fb7d311ad">
						<jr:columnHeader style="Table 2_CH" height="30">
							<staticText>
								<reportElement x="0" y="0" width="30" height="30" uuid="94be0f10-88e7-45ef-8f4b-1542271287e0"/>
								<textElement textAlignment="Center" verticalAlignment="Middle"/>
								<text><![CDATA[Eval]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="Table 2_TD" height="20">
							<image scaleImage="RealSize" hAlign="Center" vAlign="Middle" onErrorType="Icon">
								<reportElement x="0" y="0" width="30" height="20" uuid="17ad2940-70ad-4f4d-90cf-7c8a107cab04">
									<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
								</reportElement>
								<box>
									<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
									<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
									<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
									<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
								</box>
								<imageExpression><![CDATA[$F{EVAL_ID}.toString().equals("1") ? "Honda___Quadrado_Preenchido" 
: $F{EVAL_ID}.toString().equals("2") ? "hon_tri_preto"
: $F{EVAL_ID}.toString().equals("3") ? "hon_circ_preto"
: $F{EVAL_ID}.toString().equals("4") ? "hon_circ_dup"
: "hon_quad_preto"]]></imageExpression>
							</image>
						</jr:detailCell>
					</jr:column>
				</jr:table>
			</componentElement>
			<componentElement>
				<reportElement x="682" y="530" width="528" height="90" isPrintWhenDetailOverflows="true" uuid="46d27057-7fff-4a56-ab48-9afc922022da">
					<property name="com.jaspersoft.studio.layout" value="com.jaspersoft.studio.editor.layout.VerticalRowLayout"/>
					<property name="com.jaspersoft.studio.table.style.table_header" value="Table 3_TH"/>
					<property name="com.jaspersoft.studio.table.style.column_header" value="Table 3_CH"/>
					<property name="com.jaspersoft.studio.table.style.detail" value="Table 3_TD"/>
				</reportElement>
				<jr:table xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd">
					<datasetRun subDataset="changes_kpi" uuid="46819922-c88f-4dce-97d3-000d0eb69fde">
						<datasetParameter name="data_referencia">
							<datasetParameterExpression><![CDATA[$P{data_referencia}]]></datasetParameterExpression>
						</datasetParameter>
						<datasetParameter name="fase">
							<datasetParameterExpression><![CDATA[$P{fase}]]></datasetParameterExpression>
						</datasetParameter>
						<datasetParameter name="owner">
							<datasetParameterExpression><![CDATA[$P{owner}]]></datasetParameterExpression>
						</datasetParameter>
						<datasetParameter name="portfolio">
							<datasetParameterExpression><![CDATA[$P{portfolio}]]></datasetParameterExpression>
						</datasetParameter>
						<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
					</datasetRun>
					<jr:column width="240" uuid="560b7147-4d42-4cbd-ad57-d48b3a2bac66">
						<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
						<jr:columnHeader style="Table 3_CH" height="30">
							<property name="com.jaspersoft.studio.unit.height" value="px"/>
						</jr:columnHeader>
						<jr:detailCell style="Table 3_TD" height="20">
							<property name="com.jaspersoft.studio.unit.width" value="px"/>
							<textField>
								<reportElement x="0" y="0" width="240" height="20" uuid="2299cf40-987b-4425-bc3c-a9b7aab99a83"/>
								<textElement textAlignment="Center" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{META}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="70" uuid="f7b935c2-6a62-4179-ae64-b2e4ac2e1464">
						<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
						<jr:columnHeader style="Table 3_CH" height="30">
							<staticText>
								<reportElement x="0" y="0" width="70" height="30" uuid="7eac2f36-08d2-4feb-b2aa-6197f7fbdb2d"/>
								<textElement textAlignment="Center" verticalAlignment="Middle"/>
								<text><![CDATA[Qty Reqs]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="Table 3_TD" height="20">
							<property name="com.jaspersoft.studio.unit.width" value="px"/>
							<textField isBlankWhenNull="true">
								<reportElement positionType="Float" x="0" y="0" width="70" height="20" uuid="595555c4-6e7a-46ac-8eb6-ddd979856aba"/>
								<textElement textAlignment="Center" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{TOTAL}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="110" uuid="f5ebd1f5-3bf1-45a5-adba-302e600e010a">
						<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
						<jr:columnHeader style="Table 3_CH" height="30">
							<staticText>
								<reportElement x="0" y="0" width="110" height="30" uuid="54ef7b64-c2ba-4292-82fc-edc9ab96b404"/>
								<textElement textAlignment="Center" verticalAlignment="Middle"/>
								<text><![CDATA[Qty Changes]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="Table 3_TD" height="20">
							<property name="com.jaspersoft.studio.unit.width" value="px"/>
							<textField isBlankWhenNull="true">
								<reportElement x="0" y="0" width="110" height="20" uuid="75383c93-8db9-41bc-8354-875b466e10aa"/>
								<textElement textAlignment="Center" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{QTD_KPI}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="40" uuid="542f4930-7764-4e8e-b700-6fb792ec0097">
						<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
						<jr:columnHeader style="Table 3_CH" height="30">
							<staticText>
								<reportElement x="0" y="0" width="40" height="30" uuid="192a6238-c370-429c-976e-b89a4b60a9d4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle"/>
								<text><![CDATA[Target]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="Table 3_TD" height="20">
							<property name="com.jaspersoft.studio.unit.width" value="px"/>
							<textField pattern="###0.##%" isBlankWhenNull="true">
								<reportElement x="0" y="0" width="40" height="20" uuid="06b90b8e-7c90-42fc-a7fa-928330d6ce1a"/>
								<textElement textAlignment="Center" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{TARGET}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="40" uuid="7fc37a9a-05db-424d-9cd9-002abc0e625f">
						<jr:columnHeader style="Table 3_CH" height="30">
							<staticText>
								<reportElement x="0" y="0" width="40" height="30" uuid="77eb8765-8469-48b6-8a36-9374694fe775"/>
								<textElement textAlignment="Center" verticalAlignment="Middle"/>
								<text><![CDATA[Real]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="Table 3_TD" height="20">
							<property name="com.jaspersoft.studio.unit.width" value="px"/>
							<textField pattern="###0.##%" isBlankWhenNull="true">
								<reportElement x="0" y="0" width="40" height="20" uuid="5fc73e9e-499b-4e7a-8d0d-b24d8ffe68d5"/>
								<textElement textAlignment="Center" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{PCT_KPI}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="30" uuid="9243ef89-54f8-4b49-b721-dd461e3a21c4">
						<jr:columnHeader style="Table 3_CH" height="30">
							<staticText>
								<reportElement x="0" y="0" width="30" height="30" uuid="981daa75-44aa-40e9-addc-5d2617e5453f"/>
								<textElement textAlignment="Center" verticalAlignment="Middle"/>
								<text><![CDATA[Eval]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="Table 3_TD" height="20">
							<image scaleImage="RealSize" hAlign="Center" vAlign="Middle" onErrorType="Icon">
								<reportElement x="0" y="0" width="30" height="20" uuid="cc7a0377-e888-42d0-9b36-e3b010486e0a">
									<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
								</reportElement>
								<box>
									<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
									<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
									<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
									<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
								</box>
								<imageExpression><![CDATA[$F{EVAL_ID}.toString().equals("1") ? "Honda___Quadrado_Preenchido" 
: $F{EVAL_ID}.toString().equals("2") ? "hon_tri_preto"
: $F{EVAL_ID}.toString().equals("3") ? "hon_circ_preto"
: $F{EVAL_ID}.toString().equals("4") ? "hon_circ_dup"
: "hon_quad_preto"]]></imageExpression>
							</image>
						</jr:detailCell>
					</jr:column>
				</jr:table>
			</componentElement>
		</band>
	</detail>
</jasperReport>
